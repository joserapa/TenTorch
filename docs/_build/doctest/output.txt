Results of doctest builder run on 2025-01-09 18:37:20
=====================================================

Document: embeddings
--------------------
**********************************************************************
File "../tensorkrowch/embeddings.py", line ?, in default
Failed example:
    a
Expected:
    tensor([0.1916, 0.9719, 0.7613, 0.6427, 0.6945])
Got:
    tensor([1., 1., 1., 1., 1.])
**********************************************************************
File "../tensorkrowch/embeddings.py", line ?, in default
Failed example:
    emb_a
Expected:
    tensor([[ 1.0000,  0.5074,  1.3200, -1.0501,  0.9473, -1.2610],
            [ 1.0000,  1.3922, -0.2486,  1.3268, -0.4895,  1.2201],
            [ 1.0000,  0.1000, -1.4107, -1.4001, -0.1994, -0.2979],
            [ 1.0000, -0.8827, -1.1049, -0.3123,  1.3793,  1.2726],
            [ 1.0000, -0.4829, -1.3292, -1.0845,  0.9077,  1.2234]])
Got:
    tensor([[1.0000e+00, 1.4142e+00, 2.4727e-07, 1.4142e+00, 4.9454e-07, 1.4142e+00],
            [1.0000e+00, 1.4142e+00, 2.4727e-07, 1.4142e+00, 4.9454e-07, 1.4142e+00],
            [1.0000e+00, 1.4142e+00, 2.4727e-07, 1.4142e+00, 4.9454e-07, 1.4142e+00],
            [1.0000e+00, 1.4142e+00, 2.4727e-07, 1.4142e+00, 4.9454e-07, 1.4142e+00],
            [1.0000e+00, 1.4142e+00, 2.4727e-07, 1.4142e+00, 4.9454e-07, 1.4142e+00]])
**********************************************************************
1 items had failures:
   2 of  52 in default
52 tests in 1 items.
50 passed and 2 failed.
***Test Failed*** 2 failures.

Document: models
----------------
1 items passed all tests:
 118 tests in default
118 tests in 1 items.
118 passed and 0 failed.
Test passed.

Document: components
--------------------
**********************************************************************
File "../tensorkrowch/components.py", line ?, in default
Failed example:
    node.tensor
Expected:
    tensor([[-0.2799, -0.4383, -0.8387],
            [ 1.6225, -0.3370, -1.2316]])
Got:
    tensor([[-0.8197, -0.5826, -0.5851],
            [-0.0891, -0.5069, -1.1136]])
**********************************************************************
File "../tensorkrowch/components.py", line ?, in default
Failed example:
    node.sum()
Expected:
    tensor(-1.5029)
Got:
    tensor(-3.6971)
**********************************************************************
File "../tensorkrowch/components.py", line ?, in default
Failed example:
    node.sum('left')
Expected:
    tensor([ 1.3427, -0.7752, -2.0704])
Got:
    tensor([-0.9088, -1.0896, -1.6987])
**********************************************************************
File "../tensorkrowch/components.py", line ?, in default
Failed example:
    node.tensor
Expected:
    tensor([[ 1.4005, -0.0521, -1.2091],
            [ 1.9844,  0.3513, -0.5920]])
Got:
    tensor([[-0.6760, -0.7984, -0.4415],
            [ 0.6012, -0.4557,  2.4987]])
**********************************************************************
File "../tensorkrowch/components.py", line ?, in default
Failed example:
    node.mean()
Expected:
    tensor(0.3139)
Got:
    tensor(0.1214)
**********************************************************************
File "../tensorkrowch/components.py", line ?, in default
Failed example:
    node.mean('left')
Expected:
    tensor([ 1.6925,  0.1496, -0.9006])
Got:
    tensor([-0.0374, -0.6271,  1.0286])
**********************************************************************
File "../tensorkrowch/components.py", line ?, in default
Failed example:
    node.tensor
Expected:
    tensor([[ 0.2111, -0.9551, -0.7812],
            [ 0.2254,  0.3381, -0.2461]])
Got:
    tensor([[ 0.4040,  1.3967, -0.2798],
            [-0.2094, -0.1245,  0.8364]])
**********************************************************************
File "../tensorkrowch/components.py", line ?, in default
Failed example:
    node.std()
Expected:
    tensor(0.5567)
Got:
    tensor(0.6736)
**********************************************************************
File "../tensorkrowch/components.py", line ?, in default
Failed example:
    node.std('left')
Expected:
    tensor([0.0101, 0.9145, 0.3784])
Got:
    tensor([0.4337, 1.0756, 0.7893])
**********************************************************************
File "../tensorkrowch/components.py", line ?, in default
Failed example:
    node.tensor
Expected:
    tensor([[ 1.5570,  1.8441, -0.0743],
            [ 0.4572,  0.7592,  0.6356]])
Got:
    tensor([[ 0.6138, -1.4858,  1.0775],
            [-1.8030,  1.2499, -1.9019]])
**********************************************************************
File "../tensorkrowch/components.py", line ?, in default
Failed example:
    node.norm()
Expected:
    tensor(2.6495)
Got:
    tensor(3.4894)
**********************************************************************
File "../tensorkrowch/components.py", line ?, in default
Failed example:
    node.norm(axis='left')
Expected:
    tensor([1.6227, 1.9942, 0.6399])
Got:
    tensor([1.9046, 1.9416, 2.1859])
**********************************************************************
File "../tensorkrowch/components.py", line ?, in default
Failed example:
    renormA.norm()
Expected:
    tensor(1.)
Got:
    tensor(1.0000)
**********************************************************************
File "../tensorkrowch/components.py", line ?, in default
Failed example:
    node
Expected:
    Node(
        name: my_node
        tensor:
                tensor([[[-1.2517, -1.8147],
                         [-0.7997, -0.0440],
                         [-0.2808,  0.3508],
                         [-1.2380,  0.8859],
                         [-0.3585,  0.8815]],
                        [[-0.2898, -2.2775],
                         [ 1.2856, -0.3222],
                         [-0.8911, -0.4216],
                         [ 0.0086,  0.2449],
                         [-2.1998, -1.6295]]])
        axes:
                [left
                 input
                 right]
        edges:
                [my_node[left] <-> None
                 my_node[input] <-> None
                 my_node[right] <-> None])
Got:
    Node(
     	name: my_node
    	tensor:
    		tensor([[[ 0.5626,  1.0611],
    		         [-1.4774, -0.5557],
    		         [ 1.0611, -1.4294],
    		         [ 1.0383,  0.4209],
    		         [-0.0106, -0.7469]],
    		
    		        [[ 0.4802,  0.5634],
    		         [-0.9938,  0.1029],
    		         [ 1.0869, -1.1914],
    		         [-0.0259,  0.5222],
    		         [ 0.1109,  0.4089]]])
    	axes:
    		[left
    		 input
    		 right]
    	edges:
    		[my_node[left] <-> None
    		 my_node[input] <-> None
    		 my_node[right] <-> None])
**********************************************************************
File "../tensorkrowch/components.py", line ?, in default
Failed example:
    node
Expected:
    Node(
        name: node
        tensor:
                tensor([[[ 0.6545, -0.0445],
                         [-0.9265, -0.2730],
                         [-0.5069, -0.6524],
                         [-0.8227, -1.1211],
                         [ 0.2390,  0.9432]],
                        [[ 0.8633,  0.4402],
                         [-0.6982,  0.4461],
                         [-0.0633, -0.9320],
                         [ 1.6023,  0.5406],
                         [ 0.3489, -0.3088]]])
        axes:
                [axis_0
                 axis_1
                 axis_2]
        edges:
                [node[axis_0] <-> None
                 node[axis_1] <-> None
                 node[axis_2] <-> None])
Got:
    Node(
     	name: node
    	tensor:
    		tensor([[[-7.4518e-01,  1.8610e-01],
    		         [ 1.3958e+00, -2.8741e-04],
    		         [-2.1363e+00, -1.7778e+00],
    		         [ 4.8755e-01,  1.6938e-02],
    		         [-1.5654e-02, -2.0389e-01]],
    		
    		        [[-4.5928e-01,  1.4419e+00],
    		         [ 3.7191e-01,  1.1042e+00],
    		         [-2.2020e-01,  5.1657e-02],
    		         [-1.5114e+00, -4.6789e-01],
    		         [ 3.2119e-01, -2.2281e+00]]])
    	axes:
    		[axis_0
    		 axis_1
    		 axis_2]
    	edges:
    		[node[axis_0] <-> None
    		 node[axis_1] <-> None
    		 node[axis_2] <-> None])
**********************************************************************
File "../tensorkrowch/components.py", line ?, in default
Failed example:
    nodeA = nodeA.parameterize()
Exception raised:
    Traceback (most recent call last):
      File "/home/jose/anaconda3/envs/test_tk/lib/python3.11/doctest.py", line 1355, in __run
        exec(compile(example.source, filename, "single",
      File "<doctest default[0]>", line 1, in <module>
        nodeA = nodeA.parameterize()
                ^^^^^
    NameError: name 'nodeA' is not defined
**********************************************************************
File "../tensorkrowch/components.py", line ?, in default
Failed example:
    node
Expected:
    ParamNode(
        name: my_paramnode
        tensor:
                Parameter containing:
                tensor([[[ 1.8090, -0.1371],
                         [-0.0501, -1.0371],
                         [ 1.4588, -0.8361],
                         [-0.4974, -1.9957],
                         [ 0.3760, -1.0412]],
                        [[ 0.3393, -0.2503],
                         [ 1.7752, -0.0188],
                         [-0.9561, -0.0806],
                         [-1.0465, -0.5731],
                         [ 1.5021,  0.4181]]], requires_grad=True)
        axes:
                [left
                 input
                 right]
        edges:
                [my_paramnode[left] <-> None
                 my_paramnode[input] <-> None
                 my_paramnode[right] <-> None])
Got:
    ParamNode(
     	name: my_paramnode
    	tensor:
    		Parameter containing:
    		tensor([[[ 1.3261,  0.4728],
    		         [ 1.3827, -1.2370],
    		         [-0.1973,  1.4186],
    		         [ 0.3709,  1.0586],
    		         [-0.0447, -0.1549]],
    		
    		        [[-0.7739, -0.4233],
    		         [ 0.0033, -1.5453],
    		         [-2.2657,  0.1135],
    		         [-1.5748,  1.1476],
    		         [-2.3993,  2.2542]]], requires_grad=True)
    	axes:
    		[left
    		 input
    		 right]
    	edges:
    		[my_paramnode[left] <-> None
    		 my_paramnode[input] <-> None
    		 my_paramnode[right] <-> None])
**********************************************************************
File "../tensorkrowch/components.py", line ?, in default
Failed example:
    node
Expected:
    ParamNode(
        name: paramnode
        tensor:
                Parameter containing:
                tensor([[[-0.8442,  1.4184],
                         [ 0.4431, -1.4385],
                         [-0.5161, -0.6492],
                         [ 0.2095,  0.5760],
                         [-0.9925, -1.5797]],
                        [[-0.8649, -0.5401],
                         [-0.1091,  1.1654],
                         [-0.3821, -0.2477],
                         [-0.7688, -2.4731],
                         [-0.0234,  0.9618]]], requires_grad=True)
        axes:
                [axis_0
                 axis_1
                 axis_2]
        edges:
                [paramnode[axis_0] <-> None
                 paramnode[axis_1] <-> None
                 paramnode[axis_2] <-> None])
Got:
    ParamNode(
     	name: paramnode
    	tensor:
    		Parameter containing:
    		tensor([[[-1.4502,  0.0136],
    		         [ 1.7906, -0.4664],
    		         [-0.9225, -0.8192],
    		         [-0.5443, -0.4002],
    		         [-0.7617, -0.5028]],
    		
    		        [[-0.9978, -0.6888],
    		         [-0.7288, -0.5563],
    		         [ 1.6308,  0.4940],
    		         [-0.9078, -1.6230],
    		         [-0.6676,  0.7137]]], requires_grad=True)
    	axes:
    		[axis_0
    		 axis_1
    		 axis_2]
    	edges:
    		[paramnode[axis_0] <-> None
    		 paramnode[axis_1] <-> None
    		 paramnode[axis_2] <-> None])
**********************************************************************
File "../tensorkrowch/components.py", line ?, in default
Failed example:
    paramnode.tensor
Expected:
    Parameter containing:
    tensor([[-0.3340,  0.6811, -0.2866],
            [ 1.3371,  1.4761,  0.6551]], requires_grad=True)
Got:
    Parameter containing:
    tensor([[ 0.3101, -1.4499,  1.5054],
            [ 0.5247, -1.9068, -0.0841]], requires_grad=True)
**********************************************************************
File "../tensorkrowch/components.py", line ?, in default
Failed example:
    paramnodeA = paramnodeA.parameterize()
Exception raised:
    Traceback (most recent call last):
      File "/home/jose/anaconda3/envs/test_tk/lib/python3.11/doctest.py", line 1355, in __run
        exec(compile(example.source, filename, "single",
      File "<doctest default[0]>", line 1, in <module>
        paramnodeA = paramnodeA.parameterize()
                     ^^^^^^^^^^
    NameError: name 'paramnodeA' is not defined
**********************************************************************
File "../tensorkrowch/components.py", line ?, in default
Failed example:
    node = node.copy()  # .copy() calls to .delete_node()
Exception raised:
    Traceback (most recent call last):
      File "/home/jose/anaconda3/envs/test_tk/lib/python3.11/doctest.py", line 1355, in __run
        exec(compile(example.source, filename, "single",
      File "<doctest default[0]>", line 1, in <module>
        node = node.copy()  # .copy() calls to .delete_node()
               ^^^^
    NameError: name 'node' is not defined
**********************************************************************
File "../tensorkrowch/components.py", line ?, in default
Failed example:
    net['data_0']
Expected:
    Node(
        name: data_0
        tensor:
                None
        axes:
                [batch
                 feature]
        edges:
                [data_0[batch] <-> None
                 data_0[feature] <-> nodeA[input]])
Got:
    Node(
     	name: data_0
    	tensor:
    		None
    	axes:
    		[batch
    		 feature]
    	edges:
    		[data_0[batch] <-> None
    		 data_0[feature] <-> nodeA[input]])
**********************************************************************
1 items had failures:
  22 of 401 in default
401 tests in 1 items.
379 passed and 22 failed.
***Test Failed*** 22 failures.

Document: operations
--------------------
**********************************************************************
File "../tensorkrowch/operations.py", line ?, in default
Failed example:
    renormA.norm()
Expected:
    tensor(1.)
Got:
    tensor(1.0000)
**********************************************************************
1 items had failures:
   1 of 217 in default
217 tests in 1 items.
216 passed and 1 failed.
***Test Failed*** 1 failures.

Doctest summary
===============
  788 tests
   25 failures in tests
    0 failures in setup code
    0 failures in cleanup code
