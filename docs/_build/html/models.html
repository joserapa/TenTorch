
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Models &#8212; TensorKrowch 1.0.0 documentation</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="shortcut icon" href="_static/tensorkrowch_favicon_light.svg"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Initializers" href="initializers.html" />
    <link rel="prev" title="Operations" href="operations.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/tensorkrowch_logo_light.svg" class="logo" alt="logo">
      
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Contents:
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="installation.html">
   Installation
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="tutorials.html">
   Tutorials
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="tutorials/0_first_steps.html">
     First Steps with TensorKrowch
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="tutorials/1_creating_tensor_network.html">
     Creating a Tensor Network in TensorKrowch
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="tutorials/2_contracting_tensor_network.html">
     Contracting and Differentiating the Tensor Network
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="tutorials/3_memory_management.html">
     How to save Memory and Time with TensorKrowch (ADVANCED)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="tutorials/4_types_of_nodes.html">
     The different Types of Nodes (ADVANCED)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="tutorials/5_subclass_tensor_network.html">
     How to subclass TensorNetwork to build Custom Models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="tutorials/6_mix_with_pytorch.html">
     Creating a Hybrid Neural-Tensor Network Model
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="api.html">
   API Reference
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="components.html">
     Components
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="operations.html">
     Operations
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="initializers.html">
     Initializers
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="embeddings.html">
     Embeddings
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Theme by the <a href="https://ebp.jupyterbook.org">Executable Book Project</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>
<a href="https://github.com/joserapa98/tensorkrowch"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="bottom"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="_sources/models.rst.txt"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.rst</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#mpslayer">
   MPSLayer
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     MPSLayer
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#umpslayer">
     UMPSLayer
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#convmpslayer">
     ConvMPSLayer
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#convumpslayer">
     ConvUMPSLayer
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#mps">
   MPS
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id16">
     MPS
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#umps">
     UMPS
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#convmps">
     ConvMPS
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#convumps">
     ConvUMPS
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#tree">
   Tree
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id34">
     Tree
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#utree">
     UTree
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#convtree">
     ConvTree
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#convutree">
     ConvUTree
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#peps">
   PEPS
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id51">
     PEPS
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#upeps">
     UPEPS
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#convpeps">
     ConvPEPS
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#convupeps">
     ConvUPEPS
    </a>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Models</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#mpslayer">
   MPSLayer
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     MPSLayer
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#umpslayer">
     UMPSLayer
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#convmpslayer">
     ConvMPSLayer
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#convumpslayer">
     ConvUMPSLayer
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#mps">
   MPS
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id16">
     MPS
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#umps">
     UMPS
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#convmps">
     ConvMPS
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#convumps">
     ConvUMPS
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#tree">
   Tree
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id34">
     Tree
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#utree">
     UTree
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#convtree">
     ConvTree
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#convutree">
     ConvUTree
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#peps">
   PEPS
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id51">
     PEPS
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#upeps">
     UPEPS
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#convpeps">
     ConvPEPS
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#convupeps">
     ConvUPEPS
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section id="models">
<h1>Models<a class="headerlink" href="#models" title="Permalink to this headline">#</a></h1>
<section id="mpslayer">
<h2>MPSLayer<a class="headerlink" href="#mpslayer" title="Permalink to this headline">#</a></h2>
<section id="id1">
<h3>MPSLayer<a class="headerlink" href="#id1" title="Permalink to this headline">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="tensorkrowch.models.MPSLayer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tensorkrowch.models.</span></span><span class="sig-name descname"><span class="pre">MPSLayer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bond_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_position</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boundary</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'obc'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_batches</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tensorkrowch/models/mps_layer.html#MPSLayer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensorkrowch.models.MPSLayer" title="Permalink to this definition">#</a></dt>
<dd><p>Class for Matrix Product States with an extra node that is dedicated to the
output. That is, this MPS has <span class="math notranslate nohighlight">\(n\)</span> nodes, being <span class="math notranslate nohighlight">\(n-1\)</span> input nodes
connected to <code class="docutils literal notranslate"><span class="pre">data</span></code> nodes (nodes that will contain the data tensors), and
one output node, whose physical dimension (<code class="docutils literal notranslate"><span class="pre">out_dim</span></code>) is used as the label
(for classification tasks).</p>
<p>Besides, since this class has an output edge, when contracting the whole
tensor network (with input data), the result will be a vector that can be
plugged into the next layer (being this other tensor network or a neural
network layer).</p>
<p>If the physical dimensions of all the input nodes (<code class="docutils literal notranslate"><span class="pre">in_dim</span></code>) are equal,
the input data tensor can be passed as a single tensor. Otherwise, it would
have to be passed as a list of tensors with different sizes.</p>
<p>An <code class="docutils literal notranslate"><span class="pre">MPSLayer</span></code> is formed by the following nodes:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">left_node</span></code>, <code class="docutils literal notranslate"><span class="pre">right_node</span></code>: <cite>Vector</cite> nodes with axes <code class="docutils literal notranslate"><span class="pre">(&quot;input&quot;,</span> <span class="pre">&quot;right&quot;)</span></code>
and <code class="docutils literal notranslate"><span class="pre">(&quot;left&quot;,</span> <span class="pre">&quot;input&quot;)</span></code>, respectively. These are the nodes at the
extremes of the <code class="docutils literal notranslate"><span class="pre">MPSLayer</span></code>. If <code class="docutils literal notranslate"><span class="pre">boundary</span></code> is <code class="docutils literal notranslate"><span class="pre">&quot;pbc&quot;&quot;</span></code>, both are
<code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">left_env</span></code>, <code class="docutils literal notranslate"><span class="pre">right_env</span></code>: Environments of <cite>matrix</cite> nodes that are at
the left or right side of the <code class="docutils literal notranslate"><span class="pre">output_node</span></code>. These nodes have axes
<code class="docutils literal notranslate"><span class="pre">(&quot;left&quot;,</span> <span class="pre">&quot;input&quot;,</span> <span class="pre">&quot;right&quot;)</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">output_node</span></code>: Node dedicated to the output. It has axes
<code class="docutils literal notranslate"><span class="pre">(&quot;left&quot;,</span> <span class="pre">&quot;output&quot;,</span> <span class="pre">&quot;right&quot;)</span></code>.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_features</strong> (<em>int</em>) – Number of input nodes. The total number of nodes (including the output
node) will be <code class="docutils literal notranslate"><span class="pre">n_features</span> <span class="pre">+</span> <span class="pre">1</span></code>.</p></li>
<li><p><strong>in_dim</strong> (<em>int</em><em>, </em><em>list</em><em>[</em><em>int</em><em>] or </em><em>tuple</em><em>[</em><em>int</em><em>]</em>) – Input dimension. Equivalent to the physical dimension. If given as a
sequence, its length should be equal to <code class="docutils literal notranslate"><span class="pre">n_features</span></code>, since these are
the input dimensions of the input nodes.</p></li>
<li><p><strong>out_dim</strong> (<em>int</em>) – Output dimension (labels) for the output node. Plays the same role as
<code class="docutils literal notranslate"><span class="pre">in_dim</span></code> for input nodes.</p></li>
<li><p><strong>bond_dim</strong> (<em>int</em><em>, </em><em>list</em><em>[</em><em>int</em><em>] or </em><em>tuple</em><em>[</em><em>int</em><em>]</em>) – Bond dimension(s). If given as a sequence, its length should be equal
to <code class="docutils literal notranslate"><span class="pre">n_features</span> <span class="pre">+</span> <span class="pre">1</span></code> (if <code class="docutils literal notranslate"><span class="pre">boundary</span> <span class="pre">=</span> <span class="pre">&quot;pbc&quot;</span></code>) or <code class="docutils literal notranslate"><span class="pre">n_features</span></code> (if
<code class="docutils literal notranslate"><span class="pre">boundary</span> <span class="pre">=</span> <span class="pre">&quot;obc&quot;</span></code>). The i-th bond dimension is always the dimension
of the right edge of the i-th node (including output node).</p></li>
<li><p><strong>out_position</strong> (<em>int</em><em>, </em><em>optional</em>) – Position of the output node (label). Should be between 0 and
<code class="docutils literal notranslate"><span class="pre">n_features</span></code>. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, the output node will be located at the
middle of the MPS.</p></li>
<li><p><strong>boundary</strong> (<em>{&quot;obc&quot;</em><em>, </em><em>&quot;pbc&quot;}</em>) – String indicating whether periodic or open boundary conditions should
be used.</p></li>
<li><p><strong>n_batches</strong> (<em>int</em>) – Number of batch edges of input <code class="docutils literal notranslate"><span class="pre">data</span></code> nodes. Usually <code class="docutils literal notranslate"><span class="pre">n_batches</span> <span class="pre">=</span> <span class="pre">1</span></code>
(where the batch edge is used for the data batched) but it could also
be <code class="docutils literal notranslate"><span class="pre">n_batches</span> <span class="pre">=</span> <span class="pre">2</span></code> (e.g. one edge for data batched, other edge for
image patches in convolutional layers).</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<p><code class="docutils literal notranslate"><span class="pre">MPSLayer</span></code> with same input dimensions:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mps_layer</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">MPSLayer</span><span class="p">(</span><span class="n">n_features</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
<span class="gp">... </span>                               <span class="n">in_dim</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
<span class="gp">... </span>                               <span class="n">out_dim</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
<span class="gp">... </span>                               <span class="n">bond_dim</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="c1"># batch_size x n_features x feature_size</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">mps_layer</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span><span class="o">.</span><span class="n">shape</span>
<span class="go">torch.Size([20, 10])</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">MPSLayer</span></code> with different input dimensions:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mps_layer</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">MPSLayer</span><span class="p">(</span><span class="n">n_features</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
<span class="gp">... </span>                               <span class="n">in_dim</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">)),</span>
<span class="gp">... </span>                               <span class="n">out_dim</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
<span class="gp">... </span>                               <span class="n">bond_dim</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
<span class="gp">... </span>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">)]</span> <span class="c1"># n_features * [batch_size x feature_size]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">mps_layer</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span><span class="o">.</span><span class="n">shape</span>
<span class="go">torch.Size([20, 10])</span>
</pre></div>
</div>
<dl class="py property">
<dt class="sig sig-object py" id="tensorkrowch.models.MPSLayer.n_features">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">n_features</span></span><a class="headerlink" href="#tensorkrowch.models.MPSLayer.n_features" title="Permalink to this definition">#</a></dt>
<dd><p>Returns number of input nodes. The total number of nodes (including the
output node) will be <code class="docutils literal notranslate"><span class="pre">n_features</span> <span class="pre">+</span> <span class="pre">1</span></code>.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tensorkrowch.models.MPSLayer.in_dim">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">in_dim</span></span><a class="headerlink" href="#tensorkrowch.models.MPSLayer.in_dim" title="Permalink to this definition">#</a></dt>
<dd><p>Returns input dimensions.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tensorkrowch.models.MPSLayer.out_dim">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">out_dim</span></span><a class="headerlink" href="#tensorkrowch.models.MPSLayer.out_dim" title="Permalink to this definition">#</a></dt>
<dd><p>Returns the output dimension, that is, the number of labels in the
output node. Same as <code class="docutils literal notranslate"><span class="pre">in_dim</span></code> for input nodes.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tensorkrowch.models.MPSLayer.phys_dim">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">phys_dim</span></span><a class="headerlink" href="#tensorkrowch.models.MPSLayer.phys_dim" title="Permalink to this definition">#</a></dt>
<dd><p>Returns <code class="docutils literal notranslate"><span class="pre">in_dim</span></code> list with <code class="docutils literal notranslate"><span class="pre">out_dim</span></code> in the <code class="docutils literal notranslate"><span class="pre">out_position</span></code>.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tensorkrowch.models.MPSLayer.bond_dim">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">bond_dim</span></span><a class="headerlink" href="#tensorkrowch.models.MPSLayer.bond_dim" title="Permalink to this definition">#</a></dt>
<dd><p>Returns bond dimensions.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tensorkrowch.models.MPSLayer.out_position">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">out_position</span></span><a class="headerlink" href="#tensorkrowch.models.MPSLayer.out_position" title="Permalink to this definition">#</a></dt>
<dd><p>Returns position of the output node (label).</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tensorkrowch.models.MPSLayer.boundary">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">boundary</span></span><a class="headerlink" href="#tensorkrowch.models.MPSLayer.boundary" title="Permalink to this definition">#</a></dt>
<dd><p>Returns boundary condition (“obc” or “pbc”).</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tensorkrowch.models.MPSLayer.n_batches">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">n_batches</span></span><a class="headerlink" href="#tensorkrowch.models.MPSLayer.n_batches" title="Permalink to this definition">#</a></dt>
<dd><p>Returns number of batch edges of the <code class="docutils literal notranslate"><span class="pre">data</span></code> nodes.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensorkrowch.models.MPSLayer.initialize">
<span class="sig-name descname"><span class="pre">initialize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">std</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-09</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tensorkrowch/models/mps_layer.html#MPSLayer.initialize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensorkrowch.models.MPSLayer.initialize" title="Permalink to this definition">#</a></dt>
<dd><p>Initializes all the nodes.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensorkrowch.models.MPSLayer.set_data_nodes">
<span class="sig-name descname"><span class="pre">set_data_nodes</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tensorkrowch/models/mps_layer.html#MPSLayer.set_data_nodes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensorkrowch.models.MPSLayer.set_data_nodes" title="Permalink to this definition">#</a></dt>
<dd><p>Creates <code class="docutils literal notranslate"><span class="pre">data</span></code> nodes and connects each of them to the input edge of
each input node.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensorkrowch.models.MPSLayer.contract">
<span class="sig-name descname"><span class="pre">contract</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inline_input</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inline_mats</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tensorkrowch/models/mps_layer.html#MPSLayer.contract"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensorkrowch.models.MPSLayer.contract" title="Permalink to this definition">#</a></dt>
<dd><p>Contracts the whole MPS.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inline_input</strong> (<em>bool</em>) – Boolean indicating whether input <code class="docutils literal notranslate"><span class="pre">data</span></code> nodes should be contracted
with the <code class="docutils literal notranslate"><span class="pre">MPS</span></code> nodes inline (one contraction at a time) or in a
single stacked contraction.</p></li>
<li><p><strong>inline_mats</strong> (<em>bool</em>) – Boolean indicating whether the sequence of matrices (resultant
after contracting the input <code class="docutils literal notranslate"><span class="pre">data</span></code> nodes) should be contracted
inline or as a sequence of pairwise stacked contrations.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="components.html#tensorkrowch.Node" title="tensorkrowch.Node">Node</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensorkrowch.models.MPSLayer.canonicalize">
<span class="sig-name descname"><span class="pre">canonicalize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'svd'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rank</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cum_percentage</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tensorkrowch/models/mps_layer.html#MPSLayer.canonicalize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensorkrowch.models.MPSLayer.canonicalize" title="Permalink to this definition">#</a></dt>
<dd><p>Turns MPS into canonical form via local SVD/QR decompositions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mode</strong> (<em>{&quot;svd&quot;</em><em>, </em><em>&quot;svdr&quot;</em><em>, </em><em>&quot;qr&quot;}</em>) – Indicates which decomposition should be used to split a node after
contracting it. See more at <code class="xref py py-func docutils literal notranslate"><span class="pre">svd_()</span></code>, <code class="xref py py-func docutils literal notranslate"><span class="pre">svdr_()</span></code>, <code class="xref py py-func docutils literal notranslate"><span class="pre">qr_()</span></code>.
If mode is “qr”, operation <code class="xref py py-func docutils literal notranslate"><span class="pre">qr_()</span></code> will be performed on nodes at
the left of the output node, whilst operation <code class="xref py py-func docutils literal notranslate"><span class="pre">rq_()</span></code> will be
used for nodes at the right.</p></li>
<li><p><strong>rank</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of singular values to keep.</p></li>
<li><p><strong>cum_percentage</strong> (<em>float</em><em>, </em><em>optional</em>) – <p>Proportion that should be satisfied between the sum of all singular
values kept and the total sum of all singular values.</p>
<div class="math notranslate nohighlight">
\[\frac{\sum_{i \in \{kept\}}{s_i}}{\sum_{i \in \{all\}}{s_i}} \ge
cum\_percentage\]</div>
</p></li>
<li><p><strong>cutoff</strong> (<em>float</em><em>, </em><em>optional</em>) – Quantity that lower bounds singular values in order to be kept.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mps_layer</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">MPSLayer</span><span class="p">(</span><span class="n">n_features</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
<span class="gp">... </span>                               <span class="n">in_dim</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
<span class="gp">... </span>                               <span class="n">out_dim</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
<span class="gp">... </span>                               <span class="n">bond_dim</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mps_layer</span><span class="o">.</span><span class="n">canonicalize</span><span class="p">(</span><span class="n">rank</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mps_layer</span><span class="o">.</span><span class="n">bond_dim</span>
<span class="go">[2, 3, 3, 2]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensorkrowch.models.MPSLayer.canonicalize_univocal">
<span class="sig-name descname"><span class="pre">canonicalize_univocal</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tensorkrowch/models/mps_layer.html#MPSLayer.canonicalize_univocal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensorkrowch.models.MPSLayer.canonicalize_univocal" title="Permalink to this definition">#</a></dt>
<dd><p>Turns MPS into the univocal canonical form defined <a class="reference external" href="https://arxiv.org/abs/2202.12319">here</a>.</p>
</dd></dl>

</dd></dl>

</section>
<section id="umpslayer">
<h3>UMPSLayer<a class="headerlink" href="#umpslayer" title="Permalink to this headline">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="tensorkrowch.models.UMPSLayer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tensorkrowch.models.</span></span><span class="sig-name descname"><span class="pre">UMPSLayer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bond_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_position</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_batches</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tensorkrowch/models/mps_layer.html#UMPSLayer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensorkrowch.models.UMPSLayer" title="Permalink to this definition">#</a></dt>
<dd><p>Class for Uniform (translationally invariant) Matrix Product States with an
extra node that is dedicated to the output. It is the uniform version of
<a class="reference internal" href="#tensorkrowch.models.MPSLayer" title="tensorkrowch.models.MPSLayer"><code class="xref py py-class docutils literal notranslate"><span class="pre">MPSLayer</span></code></a>, that is, all input nodes share the same tensor. Thus
this class cannot have different input or bond dimensions for each node,
and boundary conditions are always periodic (<code class="docutils literal notranslate"><span class="pre">&quot;pbc&quot;</span></code>).</p>
<p>A <code class="docutils literal notranslate"><span class="pre">UMPSLayer</span></code> is formed by the following nodes:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">left_env</span></code>, <code class="docutils literal notranslate"><span class="pre">right_env</span></code>: Environments of <cite>matrix</cite> nodes that are at
the left or right side of the <code class="docutils literal notranslate"><span class="pre">output_node</span></code>. These nodes have axes
<code class="docutils literal notranslate"><span class="pre">(&quot;left&quot;,</span> <span class="pre">&quot;input&quot;,</span> <span class="pre">&quot;right&quot;)</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">output_node</span></code>: Node dedicated to the output. It has axes
<code class="docutils literal notranslate"><span class="pre">(&quot;left&quot;,</span> <span class="pre">&quot;output&quot;,</span> <span class="pre">&quot;right&quot;)</span></code>.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_features</strong> (<em>int</em>) – Number of input nodes. The total number of nodes (including the output
node) will be <code class="docutils literal notranslate"><span class="pre">n_features</span> <span class="pre">+</span> <span class="pre">1</span></code></p></li>
<li><p><strong>in_dim</strong> (<em>int</em>) – Input dimension. Equivalent to the physical dimension.</p></li>
<li><p><strong>out_dim</strong> (<em>int</em>) – Output dimension (labels) for the output node. Plays the same role as
<code class="docutils literal notranslate"><span class="pre">in_dim</span></code> for input nodes.</p></li>
<li><p><strong>bond_dim</strong> (<em>int</em>) – Bond dimension.</p></li>
<li><p><strong>out_position</strong> (<em>int</em><em>, </em><em>optional</em>) – Position of the output node (label). Should be between 0 and
<code class="docutils literal notranslate"><span class="pre">n_features</span></code>. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, the output node will be located at the
middle of the MPS.</p></li>
<li><p><strong>n_batches</strong> (<em>int</em>) – Number of batch edges of input <code class="docutils literal notranslate"><span class="pre">data</span></code> nodes. Usually <code class="docutils literal notranslate"><span class="pre">n_batches</span> <span class="pre">=</span> <span class="pre">1</span></code>
(where the batch edge is used for the data batched) but it could also
be <code class="docutils literal notranslate"><span class="pre">n_batches</span> <span class="pre">=</span> <span class="pre">2</span></code> (one edge for data batched, other edge for image
patches in convolutional layers).</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mps_layer</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">UMPSLayer</span><span class="p">(</span><span class="n">n_features</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
<span class="gp">... </span>                                <span class="n">in_dim</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
<span class="gp">... </span>                                <span class="n">out_dim</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
<span class="gp">... </span>                                <span class="n">bond_dim</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">mps_layer</span><span class="o">.</span><span class="n">left_env</span> <span class="o">+</span> <span class="n">mps_layer</span><span class="o">.</span><span class="n">right_env</span><span class="p">:</span>
<span class="gp">... </span>    <span class="k">assert</span> <span class="n">node</span><span class="o">.</span><span class="n">tensor_address</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;virtual_uniform&#39;</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="c1"># batch_size x n_features x feature_size</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">mps_layer</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span><span class="o">.</span><span class="n">shape</span>
<span class="go">torch.Size([20, 10])</span>
</pre></div>
</div>
<dl class="py property">
<dt class="sig sig-object py" id="tensorkrowch.models.UMPSLayer.n_features">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">n_features</span></span><a class="headerlink" href="#tensorkrowch.models.UMPSLayer.n_features" title="Permalink to this definition">#</a></dt>
<dd><p>Returns number of input nodes. The total number of nodes (including the
output node) will be <code class="docutils literal notranslate"><span class="pre">n_features</span> <span class="pre">+</span> <span class="pre">1</span></code>.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tensorkrowch.models.UMPSLayer.in_dim">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">in_dim</span></span><a class="headerlink" href="#tensorkrowch.models.UMPSLayer.in_dim" title="Permalink to this definition">#</a></dt>
<dd><p>Returns input dimension.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tensorkrowch.models.UMPSLayer.out_dim">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">out_dim</span></span><a class="headerlink" href="#tensorkrowch.models.UMPSLayer.out_dim" title="Permalink to this definition">#</a></dt>
<dd><p>Returns the output dimension, that is, the number of labels in the
output node. Same as <code class="docutils literal notranslate"><span class="pre">in_dim</span></code> for input nodes.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tensorkrowch.models.UMPSLayer.bond_dim">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">bond_dim</span></span><a class="headerlink" href="#tensorkrowch.models.UMPSLayer.bond_dim" title="Permalink to this definition">#</a></dt>
<dd><p>Returns bond dimensions.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tensorkrowch.models.UMPSLayer.out_position">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">out_position</span></span><a class="headerlink" href="#tensorkrowch.models.UMPSLayer.out_position" title="Permalink to this definition">#</a></dt>
<dd><p>Returns position of the output node (label).</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tensorkrowch.models.UMPSLayer.boundary">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">boundary</span></span><a class="headerlink" href="#tensorkrowch.models.UMPSLayer.boundary" title="Permalink to this definition">#</a></dt>
<dd><p>Returns boundary condition (“obc” or “pbc”).</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tensorkrowch.models.UMPSLayer.n_batches">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">n_batches</span></span><a class="headerlink" href="#tensorkrowch.models.UMPSLayer.n_batches" title="Permalink to this definition">#</a></dt>
<dd><p>Returns number of batch edges of the <code class="docutils literal notranslate"><span class="pre">data</span></code> nodes.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensorkrowch.models.UMPSLayer.initialize">
<span class="sig-name descname"><span class="pre">initialize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">std</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-09</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tensorkrowch/models/mps_layer.html#UMPSLayer.initialize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensorkrowch.models.UMPSLayer.initialize" title="Permalink to this definition">#</a></dt>
<dd><p>Initializes output and uniform nodes.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensorkrowch.models.UMPSLayer.set_data_nodes">
<span class="sig-name descname"><span class="pre">set_data_nodes</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tensorkrowch/models/mps_layer.html#UMPSLayer.set_data_nodes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensorkrowch.models.UMPSLayer.set_data_nodes" title="Permalink to this definition">#</a></dt>
<dd><p>Creates <code class="docutils literal notranslate"><span class="pre">data</span></code> nodes and connects each of them to the physical edge of
each input node.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensorkrowch.models.UMPSLayer.contract">
<span class="sig-name descname"><span class="pre">contract</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inline_input</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inline_mats</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tensorkrowch/models/mps_layer.html#UMPSLayer.contract"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensorkrowch.models.UMPSLayer.contract" title="Permalink to this definition">#</a></dt>
<dd><p>Contracts the whole MPS.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inline_input</strong> (<em>bool</em>) – Boolean indicating whether input <code class="docutils literal notranslate"><span class="pre">data</span></code> nodes should be contracted
with the <code class="docutils literal notranslate"><span class="pre">MPS</span></code> nodes inline (one contraction at a time) or in a
single stacked contraction.</p></li>
<li><p><strong>inline_mats</strong> (<em>bool</em>) – Boolean indicating whether the sequence of matrices (resultant
after contracting the input <code class="docutils literal notranslate"><span class="pre">data</span></code> nodes) should be contracted
inline or as a sequence of pairwise stacked contrations.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="components.html#tensorkrowch.Node" title="tensorkrowch.Node">Node</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="convmpslayer">
<h3>ConvMPSLayer<a class="headerlink" href="#convmpslayer" title="Permalink to this headline">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="tensorkrowch.models.ConvMPSLayer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tensorkrowch.models.</span></span><span class="sig-name descname"><span class="pre">ConvMPSLayer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bond_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dilation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_position</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boundary</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'obc'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tensorkrowch/models/mps_layer.html#ConvMPSLayer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensorkrowch.models.ConvMPSLayer" title="Permalink to this definition">#</a></dt>
<dd><p>Class for Matrix Product States with an extra node that is dedicated to the
output, and where the input data is a batch of images. It is the convolutional
version of <a class="reference internal" href="#tensorkrowch.models.MPSLayer" title="tensorkrowch.models.MPSLayer"><code class="xref py py-class docutils literal notranslate"><span class="pre">MPSLayer</span></code></a>.</p>
<p>Input data as well as initialization parameters are described in <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.Conv2d.html">torch.nn.Conv2d</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_channels</strong> (<em>int</em>) – Input channels. Same as <code class="docutils literal notranslate"><span class="pre">in_dim</span></code> in <a class="reference internal" href="#tensorkrowch.models.MPSLayer" title="tensorkrowch.models.MPSLayer"><code class="xref py py-class docutils literal notranslate"><span class="pre">MPSLayer</span></code></a>.</p></li>
<li><p><strong>out_channels</strong> (<em>int</em>) – Output channels. Same as <code class="docutils literal notranslate"><span class="pre">out_dim</span></code> in <a class="reference internal" href="#tensorkrowch.models.MPSLayer" title="tensorkrowch.models.MPSLayer"><code class="xref py py-class docutils literal notranslate"><span class="pre">MPSLayer</span></code></a>.</p></li>
<li><p><strong>bond_dim</strong> (<em>int</em><em>, </em><em>list</em><em>[</em><em>int</em><em>] or </em><em>tuple</em><em>[</em><em>int</em><em>]</em>) – Bond dimension(s). If given as a sequence, its length should be equal
to <span class="math notranslate nohighlight">\(kernel\_size_0 \cdot kernel\_size_1 + 1\)</span>
(if <code class="docutils literal notranslate"><span class="pre">boundary</span> <span class="pre">=</span> <span class="pre">&quot;pbc&quot;</span></code>) or <span class="math notranslate nohighlight">\(kernel\_size_0 \cdot kernel\_size_1\)</span>
(if <code class="docutils literal notranslate"><span class="pre">boundary</span> <span class="pre">=</span> <span class="pre">&quot;obc&quot;</span></code>). The i-th bond dimension is always the dimension
of the right edge of the i-th node (including output node).</p></li>
<li><p><strong>kernel_size</strong> (<em>int</em><em>, </em><em>list</em><em>[</em><em>int</em><em>] or </em><em>tuple</em><em>[</em><em>int</em><em>]</em>) – Kernel size used in <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.Unfold.html#torch.nn.Unfold">torch.nn.Unfold</a>.
If given as an <code class="docutils literal notranslate"><span class="pre">int</span></code>, the actual kernel size will be
<code class="docutils literal notranslate"><span class="pre">(kernel_size,</span> <span class="pre">kernel_size)</span></code>.</p></li>
<li><p><strong>stride</strong> (<em>int</em>) – <p>Stride used in <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.Unfold.html#torch.nn.Unfold">torch.nn.Unfold</a>.</p>
</p></li>
<li><p><strong>padding</strong> (<em>int</em>) – <p>Padding used in <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.Unfold.html#torch.nn.Unfold">torch.nn.Unfold</a>.
If given as an <code class="docutils literal notranslate"><span class="pre">int</span></code>, the actual kernel size will be
<code class="docutils literal notranslate"><span class="pre">(kernel_size,</span> <span class="pre">kernel_size)</span></code>.</p>
</p></li>
<li><p><strong>dilation</strong> (<em>int</em>) – <p>Dilation used in <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.Unfold.html#torch.nn.Unfold">torch.nn.Unfold</a>.
If given as an <code class="docutils literal notranslate"><span class="pre">int</span></code>, the actual kernel size will be
<code class="docutils literal notranslate"><span class="pre">(kernel_size,</span> <span class="pre">kernel_size)</span></code>.</p>
</p></li>
<li><p><strong>out_position</strong> (<em>int</em><em>, </em><em>optional</em>) – Position of the output node (label). Should be between 0 and
<span class="math notranslate nohighlight">\(kernel\_size_0 \cdot kernel\_size_1\)</span>. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, the output node
will be located at the middle of the MPS.</p></li>
<li><p><strong>boundary</strong> (<em>{&quot;obc&quot;</em><em>, </em><em>&quot;pbc&quot;}</em>) – String indicating whether periodic or open boundary conditions should
be used.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">conv_mps_layer</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">ConvMPSLayer</span><span class="p">(</span><span class="n">in_channels</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
<span class="gp">... </span>                                        <span class="n">out_channels</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
<span class="gp">... </span>                                        <span class="n">bond_dim</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
<span class="gp">... </span>                                        <span class="n">kernel_size</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="c1"># batch_size x in_channels x height x width</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">conv_mps_layer</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span><span class="o">.</span><span class="n">shape</span>
<span class="go">torch.Size([20, 10, 1, 1])</span>
</pre></div>
</div>
<dl class="py property">
<dt class="sig sig-object py" id="tensorkrowch.models.ConvMPSLayer.in_channels">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">in_channels</span></span><a class="headerlink" href="#tensorkrowch.models.ConvMPSLayer.in_channels" title="Permalink to this definition">#</a></dt>
<dd><p>Returns <code class="docutils literal notranslate"><span class="pre">in_channels</span></code>. Same as <code class="docutils literal notranslate"><span class="pre">in_dim</span></code> in <a class="reference internal" href="#tensorkrowch.models.MPSLayer" title="tensorkrowch.models.MPSLayer"><code class="xref py py-class docutils literal notranslate"><span class="pre">MPSLayer</span></code></a>.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tensorkrowch.models.ConvMPSLayer.kernel_size">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">kernel_size</span></span><a class="headerlink" href="#tensorkrowch.models.ConvMPSLayer.kernel_size" title="Permalink to this definition">#</a></dt>
<dd><p>Returns <code class="docutils literal notranslate"><span class="pre">kernel_size</span></code>. Number of nodes is given by
<span class="math notranslate nohighlight">\(kernel\_size_0 \cdot kernel\_size_1 + 1\)</span>.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tensorkrowch.models.ConvMPSLayer.stride">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">stride</span></span><a class="headerlink" href="#tensorkrowch.models.ConvMPSLayer.stride" title="Permalink to this definition">#</a></dt>
<dd><p>Returns stride used in <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.Unfold.html#torch.nn.Unfold">torch.nn.Unfold</a>.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tensorkrowch.models.ConvMPSLayer.padding">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">padding</span></span><a class="headerlink" href="#tensorkrowch.models.ConvMPSLayer.padding" title="Permalink to this definition">#</a></dt>
<dd><p>Returns padding used in <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.Unfold.html#torch.nn.Unfold">torch.nn.Unfold</a>.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tensorkrowch.models.ConvMPSLayer.dilation">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dilation</span></span><a class="headerlink" href="#tensorkrowch.models.ConvMPSLayer.dilation" title="Permalink to this definition">#</a></dt>
<dd><p>Returns dilation used in <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.Unfold.html#torch.nn.Unfold">torch.nn.Unfold</a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensorkrowch.models.ConvMPSLayer.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'flat'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tensorkrowch/models/mps_layer.html#ConvMPSLayer.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensorkrowch.models.ConvMPSLayer.forward" title="Permalink to this definition">#</a></dt>
<dd><p>Overrides <code class="docutils literal notranslate"><span class="pre">torch.nn.Module</span></code>’s forward to compute a convolution on the
input image.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image</strong> (<em>torch.Tensor</em>) – <p>Input batch of images with shape</p>
<div class="math notranslate nohighlight">
\[batch\_size \times in\_channels \times height \times width\]</div>
</p></li>
<li><p><strong>mode</strong> (<em>{&quot;flat&quot;</em><em>, </em><em>&quot;snake&quot;}</em>) – Indicates the order in which MPS should take the pixels in the image.
When <code class="docutils literal notranslate"><span class="pre">&quot;flat&quot;</span></code>, the image is flattened putting one row of the image
after the other. When <code class="docutils literal notranslate"><span class="pre">&quot;snake&quot;</span></code>, its row is put in the opposite
orientation as the previous row (like a snake running through the
image).</p></li>
<li><p><strong>args</strong> – Arguments that might be used in <a class="reference internal" href="#tensorkrowch.models.MPSLayer.contract" title="tensorkrowch.models.MPSLayer.contract"><code class="xref py py-meth docutils literal notranslate"><span class="pre">contract()</span></code></a>.</p></li>
<li><p><strong>kwargs</strong> – Keyword arguments that might be used in <a class="reference internal" href="#tensorkrowch.models.MPSLayer.contract" title="tensorkrowch.models.MPSLayer.contract"><code class="xref py py-meth docutils literal notranslate"><span class="pre">contract()</span></code></a>,
like <code class="docutils literal notranslate"><span class="pre">inline_input</span></code> or <code class="docutils literal notranslate"><span class="pre">inline_mats</span></code>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="convumpslayer">
<h3>ConvUMPSLayer<a class="headerlink" href="#convumpslayer" title="Permalink to this headline">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="tensorkrowch.models.ConvUMPSLayer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tensorkrowch.models.</span></span><span class="sig-name descname"><span class="pre">ConvUMPSLayer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bond_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dilation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_position</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tensorkrowch/models/mps_layer.html#ConvUMPSLayer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensorkrowch.models.ConvUMPSLayer" title="Permalink to this definition">#</a></dt>
<dd><p>Class for Uniform Matrix Product States with an extra node that is dedicated
to the output, and where the input data is a batch of images. It is the
convolutional version of <a class="reference internal" href="#tensorkrowch.models.UMPSLayer" title="tensorkrowch.models.UMPSLayer"><code class="xref py py-class docutils literal notranslate"><span class="pre">UMPSLayer</span></code></a>. This class cannot have different
bond dimensions for each site and boundary conditions are always periodic.</p>
<p>Input data as well as initialization parameters are described in <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.Conv2d.html">torch.nn.Conv2d</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_channels</strong> (<em>int</em>) – Input channels. Same as <code class="docutils literal notranslate"><span class="pre">in_dim</span></code> in <a class="reference internal" href="#tensorkrowch.models.UMPSLayer" title="tensorkrowch.models.UMPSLayer"><code class="xref py py-class docutils literal notranslate"><span class="pre">UMPSLayer</span></code></a>.</p></li>
<li><p><strong>out_channels</strong> (<em>int</em>) – Output channels. Same as <code class="docutils literal notranslate"><span class="pre">out_dim</span></code> in <a class="reference internal" href="#tensorkrowch.models.UMPSLayer" title="tensorkrowch.models.UMPSLayer"><code class="xref py py-class docutils literal notranslate"><span class="pre">UMPSLayer</span></code></a>.</p></li>
<li><p><strong>bond_dim</strong> (<em>int</em>) – Bond dimension.</p></li>
<li><p><strong>kernel_size</strong> (<em>int</em><em>, </em><em>list</em><em>[</em><em>int</em><em>] or </em><em>tuple</em><em>[</em><em>int</em><em>]</em>) – <p>Kernel size used in <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.Unfold.html#torch.nn.Unfold">torch.nn.Unfold</a>.
If given as an <code class="docutils literal notranslate"><span class="pre">int</span></code>, the actual kernel size will be
<code class="docutils literal notranslate"><span class="pre">(kernel_size,</span> <span class="pre">kernel_size)</span></code>.</p>
</p></li>
<li><p><strong>stride</strong> (<em>int</em>) – <p>Stride used in <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.Unfold.html#torch.nn.Unfold">torch.nn.Unfold</a>.</p>
</p></li>
<li><p><strong>padding</strong> (<em>int</em>) – <p>Padding used in <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.Unfold.html#torch.nn.Unfold">torch.nn.Unfold</a>.
If given as an <code class="docutils literal notranslate"><span class="pre">int</span></code>, the actual kernel size will be
<code class="docutils literal notranslate"><span class="pre">(kernel_size,</span> <span class="pre">kernel_size)</span></code>.</p>
</p></li>
<li><p><strong>dilation</strong> (<em>int</em>) – <p>Dilation used in <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.Unfold.html#torch.nn.Unfold">torch.nn.Unfold</a>.
If given as an <code class="docutils literal notranslate"><span class="pre">int</span></code>, the actual kernel size will be
<code class="docutils literal notranslate"><span class="pre">(kernel_size,</span> <span class="pre">kernel_size)</span></code>.</p>
</p></li>
<li><p><strong>out_position</strong> (<em>int</em><em>, </em><em>optional</em>) – Position of the output node (label). Should be between 0 and
<span class="math notranslate nohighlight">\(kernel\_size_0 \cdot kernel\_size_1\)</span>. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, the output node
will be located at the middle of the MPS.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">conv_mps_layer</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">ConvUMPSLayer</span><span class="p">(</span><span class="n">in_channels</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
<span class="gp">... </span>                                         <span class="n">out_channels</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
<span class="gp">... </span>                                         <span class="n">bond_dim</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
<span class="gp">... </span>                                         <span class="n">kernel_size</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">conv_mps_layer</span><span class="o">.</span><span class="n">left_env</span> <span class="o">+</span> <span class="n">conv_mps_layer</span><span class="o">.</span><span class="n">right_env</span><span class="p">:</span>
<span class="gp">... </span>    <span class="k">assert</span> <span class="n">node</span><span class="o">.</span><span class="n">tensor_address</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;virtual_uniform&#39;</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="c1"># batch_size x in_channels x height x width</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">conv_mps_layer</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span><span class="o">.</span><span class="n">shape</span>
<span class="go">torch.Size([20, 10, 1, 1])</span>
</pre></div>
</div>
<dl class="py property">
<dt class="sig sig-object py" id="tensorkrowch.models.ConvUMPSLayer.in_channels">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">in_channels</span></span><a class="headerlink" href="#tensorkrowch.models.ConvUMPSLayer.in_channels" title="Permalink to this definition">#</a></dt>
<dd><p>Returns <code class="docutils literal notranslate"><span class="pre">in_channels</span></code>. Same as <code class="docutils literal notranslate"><span class="pre">in_dim</span></code> in <a class="reference internal" href="#tensorkrowch.models.UMPSLayer" title="tensorkrowch.models.UMPSLayer"><code class="xref py py-class docutils literal notranslate"><span class="pre">UMPSLayer</span></code></a>.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tensorkrowch.models.ConvUMPSLayer.kernel_size">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">kernel_size</span></span><a class="headerlink" href="#tensorkrowch.models.ConvUMPSLayer.kernel_size" title="Permalink to this definition">#</a></dt>
<dd><p>Returns <code class="docutils literal notranslate"><span class="pre">kernel_size</span></code>. Number of nodes is given by
<span class="math notranslate nohighlight">\(kernel\_size_0 \cdot kernel\_size_1 + 1\)</span>.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tensorkrowch.models.ConvUMPSLayer.stride">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">stride</span></span><a class="headerlink" href="#tensorkrowch.models.ConvUMPSLayer.stride" title="Permalink to this definition">#</a></dt>
<dd><p>Returns stride used in <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.Unfold.html#torch.nn.Unfold">torch.nn.Unfold</a>.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tensorkrowch.models.ConvUMPSLayer.padding">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">padding</span></span><a class="headerlink" href="#tensorkrowch.models.ConvUMPSLayer.padding" title="Permalink to this definition">#</a></dt>
<dd><p>Returns padding used in <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.Unfold.html#torch.nn.Unfold">torch.nn.Unfold</a>.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tensorkrowch.models.ConvUMPSLayer.dilation">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dilation</span></span><a class="headerlink" href="#tensorkrowch.models.ConvUMPSLayer.dilation" title="Permalink to this definition">#</a></dt>
<dd><p>Returns dilation used in <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.Unfold.html#torch.nn.Unfold">torch.nn.Unfold</a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensorkrowch.models.ConvUMPSLayer.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'flat'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tensorkrowch/models/mps_layer.html#ConvUMPSLayer.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensorkrowch.models.ConvUMPSLayer.forward" title="Permalink to this definition">#</a></dt>
<dd><p>Overrides <code class="docutils literal notranslate"><span class="pre">torch.nn.Module</span></code>’s forward to compute a convolution on the
input image.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image</strong> (<em>torch.Tensor</em>) – <p>Input batch of images with shape</p>
<div class="math notranslate nohighlight">
\[batch\_size \times in\_channels \times height \times width\]</div>
</p></li>
<li><p><strong>mode</strong> (<em>{&quot;flat&quot;</em><em>, </em><em>&quot;snake&quot;}</em>) – Indicates the order in which MPS should take the pixels in the image.
When <code class="docutils literal notranslate"><span class="pre">&quot;flat&quot;</span></code>, the image is flattened putting one row of the image
after the other. When <code class="docutils literal notranslate"><span class="pre">&quot;snake&quot;</span></code>, its row is put in the opposite
orientation as the previous row (like a snake running through the
image).</p></li>
<li><p><strong>args</strong> – Arguments that might be used in <a class="reference internal" href="#tensorkrowch.models.UMPSLayer.contract" title="tensorkrowch.models.UMPSLayer.contract"><code class="xref py py-meth docutils literal notranslate"><span class="pre">contract()</span></code></a>.</p></li>
<li><p><strong>kwargs</strong> – Keyword arguments that might be used in <a class="reference internal" href="#tensorkrowch.models.UMPSLayer.contract" title="tensorkrowch.models.UMPSLayer.contract"><code class="xref py py-meth docutils literal notranslate"><span class="pre">contract()</span></code></a>,
like <code class="docutils literal notranslate"><span class="pre">inline_input</span></code> or <code class="docutils literal notranslate"><span class="pre">inline_mats</span></code>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
</section>
<section id="mps">
<h2>MPS<a class="headerlink" href="#mps" title="Permalink to this headline">#</a></h2>
<section id="id16">
<h3>MPS<a class="headerlink" href="#id16" title="Permalink to this headline">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="tensorkrowch.models.MPS">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tensorkrowch.models.</span></span><span class="sig-name descname"><span class="pre">MPS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bond_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boundary</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'obc'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_batches</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tensorkrowch/models/mps.html#MPS"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensorkrowch.models.MPS" title="Permalink to this definition">#</a></dt>
<dd><p>Class for Matrix Product States, where all nodes are input nodes, that is,
they are all connected to <code class="docutils literal notranslate"><span class="pre">data</span></code> nodes that will store the input data
tensor(s). When contracting the MPS with new input data, the result will
be a just a number.</p>
<p>If the input dimensions of all the input nodes are equal, the input data
tensor can be passed as a single tensor. Otherwise, it would have to be
passed as a list of tensors with different sizes.</p>
<p>An <code class="docutils literal notranslate"><span class="pre">MPS</span></code> is formed by the following nodes:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">left_node</span></code>, <code class="docutils literal notranslate"><span class="pre">right_node</span></code>: <cite>Vector</cite> nodes with axes <code class="docutils literal notranslate"><span class="pre">(&quot;input&quot;,</span> <span class="pre">&quot;right&quot;)</span></code>
and <code class="docutils literal notranslate"><span class="pre">(&quot;left&quot;,</span> <span class="pre">&quot;input&quot;)</span></code>, respectively. These are the nodes at the
extremes of the <code class="docutils literal notranslate"><span class="pre">MPS</span></code>. If <code class="docutils literal notranslate"><span class="pre">boundary</span></code> is <code class="docutils literal notranslate"><span class="pre">&quot;pbc&quot;&quot;</span></code>, both are <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">mats_env</span></code>: Environment of <cite>matrix</cite> nodes that. These nodes have axes
<code class="docutils literal notranslate"><span class="pre">(&quot;left&quot;,</span> <span class="pre">&quot;input&quot;,</span> <span class="pre">&quot;right&quot;)</span></code>.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_features</strong> (<em>int</em>) – Number of input nodes.</p></li>
<li><p><strong>in_dim</strong> (<em>int</em><em>, </em><em>list</em><em>[</em><em>int</em><em>] or </em><em>tuple</em><em>[</em><em>int</em><em>]</em>) – Input dimension(s). If given as a sequence, its length should be
equal to <code class="docutils literal notranslate"><span class="pre">n_features</span></code>.</p></li>
<li><p><strong>bond_dim</strong> (<em>int</em><em>, </em><em>list</em><em>[</em><em>int</em><em>] or </em><em>tuple</em><em>[</em><em>int</em><em>]</em>) – Bond dimension(s). If given as a sequence, its length should be equal
to <code class="docutils literal notranslate"><span class="pre">n_features</span></code> (if <code class="docutils literal notranslate"><span class="pre">boundary</span> <span class="pre">=</span> <span class="pre">&quot;pbc&quot;</span></code>) or <code class="docutils literal notranslate"><span class="pre">n_features</span> <span class="pre">-</span> <span class="pre">1</span></code> (if
<code class="docutils literal notranslate"><span class="pre">boundary</span> <span class="pre">=</span> <span class="pre">&quot;obc&quot;</span></code>). The i-th bond dimension is always the dimension
of the right edge of the i-th node.</p></li>
<li><p><strong>boundary</strong> (<em>{&quot;obc&quot;</em><em>, </em><em>&quot;pbc&quot;}</em>) – String indicating whether periodic or open boundary conditions should
be used.</p></li>
<li><p><strong>n_batches</strong> (<em>int</em>) – Number of batch edges of input <code class="docutils literal notranslate"><span class="pre">data</span></code> nodes. Usually <code class="docutils literal notranslate"><span class="pre">n_batches</span> <span class="pre">=</span> <span class="pre">1</span></code>
(where the batch edge is used for the data batched) but it could also
be <code class="docutils literal notranslate"><span class="pre">n_batches</span> <span class="pre">=</span> <span class="pre">2</span></code> (one edge for data batched, other edge for image
patches in convolutional layers).</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<p><code class="docutils literal notranslate"><span class="pre">MPS</span></code> with same physical dimensions:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mps</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">MPS</span><span class="p">(</span><span class="n">n_features</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
<span class="gp">... </span>                    <span class="n">in_dim</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
<span class="gp">... </span>                    <span class="n">bond_dim</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="c1"># batch_size x n_features x feature_size</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">mps</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span><span class="o">.</span><span class="n">shape</span>
<span class="go">torch.Size([20])</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">MPS</span></code> with different physical dimensions:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mps</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">MPS</span><span class="p">(</span><span class="n">n_features</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
<span class="gp">... </span>                    <span class="n">in_dim</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">7</span><span class="p">)),</span>
<span class="gp">... </span>                    <span class="n">bond_dim</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
<span class="gp">... </span>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">7</span><span class="p">)]</span> <span class="c1"># n_features * [batch_size x feature_size]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">mps</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span><span class="o">.</span><span class="n">shape</span>
<span class="go">torch.Size([20])</span>
</pre></div>
</div>
<dl class="py property">
<dt class="sig sig-object py" id="tensorkrowch.models.MPS.n_features">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">n_features</span></span><a class="headerlink" href="#tensorkrowch.models.MPS.n_features" title="Permalink to this definition">#</a></dt>
<dd><p>Returns number of nodes.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tensorkrowch.models.MPS.boundary">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">boundary</span></span><a class="headerlink" href="#tensorkrowch.models.MPS.boundary" title="Permalink to this definition">#</a></dt>
<dd><p>Returns boundary condition (“obc” or “pbc”).</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tensorkrowch.models.MPS.in_dim">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">in_dim</span></span><a class="headerlink" href="#tensorkrowch.models.MPS.in_dim" title="Permalink to this definition">#</a></dt>
<dd><p>Returns physical dimension.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tensorkrowch.models.MPS.bond_dim">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">bond_dim</span></span><a class="headerlink" href="#tensorkrowch.models.MPS.bond_dim" title="Permalink to this definition">#</a></dt>
<dd><p>Returns bond dimension.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tensorkrowch.models.MPS.n_batches">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">n_batches</span></span><a class="headerlink" href="#tensorkrowch.models.MPS.n_batches" title="Permalink to this definition">#</a></dt>
<dd><p>Returns number of batch edges of the <code class="docutils literal notranslate"><span class="pre">data</span></code> nodes.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensorkrowch.models.MPS.initialize">
<span class="sig-name descname"><span class="pre">initialize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">std</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-09</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tensorkrowch/models/mps.html#MPS.initialize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensorkrowch.models.MPS.initialize" title="Permalink to this definition">#</a></dt>
<dd><p>Initializes all the nodes.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensorkrowch.models.MPS.set_data_nodes">
<span class="sig-name descname"><span class="pre">set_data_nodes</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tensorkrowch/models/mps.html#MPS.set_data_nodes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensorkrowch.models.MPS.set_data_nodes" title="Permalink to this definition">#</a></dt>
<dd><p>Creates <code class="docutils literal notranslate"><span class="pre">data</span></code> nodes and connects each of them to the physical edge of
each input node.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensorkrowch.models.MPS.contract">
<span class="sig-name descname"><span class="pre">contract</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inline_input</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inline_mats</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tensorkrowch/models/mps.html#MPS.contract"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensorkrowch.models.MPS.contract" title="Permalink to this definition">#</a></dt>
<dd><p>Contracts the whole MPS.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inline_input</strong> (<em>bool</em>) – Boolean indicating whether input <code class="docutils literal notranslate"><span class="pre">data</span></code> nodes should be contracted
with the <code class="docutils literal notranslate"><span class="pre">MPS</span></code> nodes inline (one contraction at a time) or in a
single stacked contraction.</p></li>
<li><p><strong>inline_mats</strong> (<em>bool</em>) – Boolean indicating whether the sequence of matrices (resultant
after contracting the input <code class="docutils literal notranslate"><span class="pre">data</span></code> nodes) should be contracted
inline or as a sequence of pairwise stacked contrations.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="components.html#tensorkrowch.Node" title="tensorkrowch.Node">Node</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensorkrowch.models.MPS.canonicalize">
<span class="sig-name descname"><span class="pre">canonicalize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">oc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'svd'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rank</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cum_percentage</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tensorkrowch/models/mps.html#MPS.canonicalize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensorkrowch.models.MPS.canonicalize" title="Permalink to this definition">#</a></dt>
<dd><p>Turns MPS into canonical form via local SVD/QR decompositions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>oc</strong> (<em>int</em>) – Position of the orthogonality center. It should be between 0 and
<code class="docutils literal notranslate"><span class="pre">n_features</span> <span class="pre">-1</span></code>.</p></li>
<li><p><strong>mode</strong> (<em>{&quot;svd&quot;</em><em>, </em><em>&quot;svdr&quot;</em><em>, </em><em>&quot;qr&quot;}</em>) – Indicates which decomposition should be used to split a node after
contracting it. See more at <code class="xref py py-func docutils literal notranslate"><span class="pre">svd_()</span></code>, <code class="xref py py-func docutils literal notranslate"><span class="pre">svdr_()</span></code>, <code class="xref py py-func docutils literal notranslate"><span class="pre">qr_()</span></code>.
If mode is “qr”, operation <code class="xref py py-func docutils literal notranslate"><span class="pre">qr_()</span></code> will be performed on nodes at
the left of the output node, whilst operation <code class="xref py py-func docutils literal notranslate"><span class="pre">rq_()</span></code> will be
used for nodes at the right.</p></li>
<li><p><strong>rank</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of singular values to keep.</p></li>
<li><p><strong>cum_percentage</strong> (<em>float</em><em>, </em><em>optional</em>) – <p>Proportion that should be satisfied between the sum of all singular
values kept and the total sum of all singular values.</p>
<div class="math notranslate nohighlight">
\[\frac{\sum_{i \in \{kept\}}{s_i}}{\sum_{i \in \{all\}}{s_i}} \ge
cum\_percentage\]</div>
</p></li>
<li><p><strong>cutoff</strong> (<em>float</em><em>, </em><em>optional</em>) – Quantity that lower bounds singular values in order to be kept.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mps</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">MPS</span><span class="p">(</span><span class="n">n_features</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
<span class="gp">... </span>                    <span class="n">in_dim</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
<span class="gp">... </span>                    <span class="n">bond_dim</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mps</span><span class="o">.</span><span class="n">canonicalize</span><span class="p">(</span><span class="n">rank</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mps</span><span class="o">.</span><span class="n">bond_dim</span>
<span class="go">[2, 3, 2]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensorkrowch.models.MPS.canonicalize_univocal">
<span class="sig-name descname"><span class="pre">canonicalize_univocal</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tensorkrowch/models/mps.html#MPS.canonicalize_univocal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensorkrowch.models.MPS.canonicalize_univocal" title="Permalink to this definition">#</a></dt>
<dd><p>Turns MPS into the univocal canonical form defined <a class="reference external" href="https://arxiv.org/abs/2202.12319">here</a>.</p>
</dd></dl>

</dd></dl>

</section>
<section id="umps">
<h3>UMPS<a class="headerlink" href="#umps" title="Permalink to this headline">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="tensorkrowch.models.UMPS">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tensorkrowch.models.</span></span><span class="sig-name descname"><span class="pre">UMPS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bond_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_batches</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tensorkrowch/models/mps.html#UMPS"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensorkrowch.models.UMPS" title="Permalink to this definition">#</a></dt>
<dd><p>Class for Uniform (translationally invariant) Matrix Product States where
all nodes are input nodes. It is the uniform version of <a class="reference internal" href="#tensorkrowch.models.MPS" title="tensorkrowch.models.MPS"><code class="xref py py-class docutils literal notranslate"><span class="pre">MPS</span></code></a>, that
is, all nodes share the same tensor. Thus this class cannot have different
input or bond dimensions for each node, and boundary conditions are
always periodic (<code class="docutils literal notranslate"><span class="pre">&quot;pbc&quot;</span></code>).</p>
<p>A <code class="docutils literal notranslate"><span class="pre">UMPS</span></code> is formed by the following nodes:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">mats_env</span></code>: Environment of <cite>matrix</cite> nodes that. These nodes have axes
<code class="docutils literal notranslate"><span class="pre">(&quot;left&quot;,</span> <span class="pre">&quot;input&quot;,</span> <span class="pre">&quot;right&quot;)</span></code>.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_features</strong> (<em>int</em>) – Number of input nodes.</p></li>
<li><p><strong>in_dim</strong> (<em>int</em>) – Input dimension. Equivalent to the physical dimension.</p></li>
<li><p><strong>bond_dim</strong> (<em>int</em>) – Bond dimension.</p></li>
<li><p><strong>n_batches</strong> (<em>int</em>) – Number of batch edges of input <code class="docutils literal notranslate"><span class="pre">data</span></code> nodes. Usually <code class="docutils literal notranslate"><span class="pre">n_batches</span> <span class="pre">=</span> <span class="pre">1</span></code>
(where the batch edge is used for the data batched) but it could also
be <code class="docutils literal notranslate"><span class="pre">n_batches</span> <span class="pre">=</span> <span class="pre">2</span></code> (one edge for data batched, other edge for image
patches in convolutional layers).</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mps</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">UMPS</span><span class="p">(</span><span class="n">n_features</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
<span class="gp">... </span>                     <span class="n">in_dim</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
<span class="gp">... </span>                     <span class="n">bond_dim</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">mps</span><span class="o">.</span><span class="n">mats_env</span><span class="p">:</span>
<span class="gp">... </span>    <span class="k">assert</span> <span class="n">node</span><span class="o">.</span><span class="n">tensor_address</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;virtual_uniform&#39;</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="c1"># batch_size x n_features x feature_size</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">mps</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span><span class="o">.</span><span class="n">shape</span>
<span class="go">torch.Size([20])</span>
</pre></div>
</div>
<dl class="py property">
<dt class="sig sig-object py" id="tensorkrowch.models.UMPS.n_features">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">n_features</span></span><a class="headerlink" href="#tensorkrowch.models.UMPS.n_features" title="Permalink to this definition">#</a></dt>
<dd><p>Returns number of nodes.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tensorkrowch.models.UMPS.in_dim">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">in_dim</span></span><a class="headerlink" href="#tensorkrowch.models.UMPS.in_dim" title="Permalink to this definition">#</a></dt>
<dd><p>Returns input dimension.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tensorkrowch.models.UMPS.bond_dim">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">bond_dim</span></span><a class="headerlink" href="#tensorkrowch.models.UMPS.bond_dim" title="Permalink to this definition">#</a></dt>
<dd><p>Returns bond dimension.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tensorkrowch.models.UMPS.n_batches">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">n_batches</span></span><a class="headerlink" href="#tensorkrowch.models.UMPS.n_batches" title="Permalink to this definition">#</a></dt>
<dd><p>Returns number of batch edges of the <code class="docutils literal notranslate"><span class="pre">data</span></code> nodes.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensorkrowch.models.UMPS.initialize">
<span class="sig-name descname"><span class="pre">initialize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">std</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-09</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tensorkrowch/models/mps.html#UMPS.initialize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensorkrowch.models.UMPS.initialize" title="Permalink to this definition">#</a></dt>
<dd><p>Initializes output and uniform nodes.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensorkrowch.models.UMPS.set_data_nodes">
<span class="sig-name descname"><span class="pre">set_data_nodes</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tensorkrowch/models/mps.html#UMPS.set_data_nodes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensorkrowch.models.UMPS.set_data_nodes" title="Permalink to this definition">#</a></dt>
<dd><p>Creates <code class="docutils literal notranslate"><span class="pre">data</span></code> nodes and connects each of them to the physical edge of
each input node.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensorkrowch.models.UMPS.contract">
<span class="sig-name descname"><span class="pre">contract</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inline_input</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inline_mats</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tensorkrowch/models/mps.html#UMPS.contract"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensorkrowch.models.UMPS.contract" title="Permalink to this definition">#</a></dt>
<dd><p>Contracts the whole MPS.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inline_input</strong> (<em>bool</em>) – Boolean indicating whether input <code class="docutils literal notranslate"><span class="pre">data</span></code> nodes should be contracted
with the <code class="docutils literal notranslate"><span class="pre">MPS</span></code> nodes inline (one contraction at a time) or in a
single stacked contraction.</p></li>
<li><p><strong>inline_mats</strong> (<em>bool</em>) – Boolean indicating whether the sequence of matrices (resultant
after contracting the input <code class="docutils literal notranslate"><span class="pre">data</span></code> nodes) should be contracted
inline or as a sequence of pairwise stacked contrations.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="components.html#tensorkrowch.Node" title="tensorkrowch.Node">Node</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="convmps">
<h3>ConvMPS<a class="headerlink" href="#convmps" title="Permalink to this headline">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="tensorkrowch.models.ConvMPS">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tensorkrowch.models.</span></span><span class="sig-name descname"><span class="pre">ConvMPS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bond_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dilation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boundary</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'obc'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tensorkrowch/models/mps.html#ConvMPS"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensorkrowch.models.ConvMPS" title="Permalink to this definition">#</a></dt>
<dd><p>Class for Matrix Product States, where all nodes are input nodes, and where
the input data is a batch of images. It is the convolutional version of
<a class="reference internal" href="#tensorkrowch.models.MPS" title="tensorkrowch.models.MPS"><code class="xref py py-class docutils literal notranslate"><span class="pre">MPS</span></code></a>.</p>
<p>Input data as well as initialization parameters are described in <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.Conv2d.html">torch.nn.Conv2d</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_channels</strong> (<em>int</em>) – Input channels. Same as <code class="docutils literal notranslate"><span class="pre">in_dim</span></code> in <a class="reference internal" href="#tensorkrowch.models.MPS" title="tensorkrowch.models.MPS"><code class="xref py py-class docutils literal notranslate"><span class="pre">MPS</span></code></a>.</p></li>
<li><p><strong>bond_dim</strong> (<em>int</em><em>, </em><em>list</em><em>[</em><em>int</em><em>] or </em><em>tuple</em><em>[</em><em>int</em><em>]</em>) – Bond dimension(s). If given as a sequence, its length should be equal
to <span class="math notranslate nohighlight">\(kernel\_size_0 \cdot kernel\_size_1\)</span> (if <code class="docutils literal notranslate"><span class="pre">boundary</span> <span class="pre">=</span> <span class="pre">&quot;pbc&quot;</span></code>)
or <span class="math notranslate nohighlight">\(kernel\_size_0 \cdot kernel\_size_1 - 1\)</span> (if
<code class="docutils literal notranslate"><span class="pre">boundary</span> <span class="pre">=</span> <span class="pre">&quot;obc&quot;</span></code>). The i-th bond dimension is always the dimension
of the right edge of the i-th node.</p></li>
<li><p><strong>kernel_size</strong> (<em>int</em><em>, </em><em>list</em><em>[</em><em>int</em><em>] or </em><em>tuple</em><em>[</em><em>int</em><em>]</em>) – <p>Kernel size used in <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.Unfold.html#torch.nn.Unfold">torch.nn.Unfold</a>.
If given as an <code class="docutils literal notranslate"><span class="pre">int</span></code>, the actual kernel size will be
<code class="docutils literal notranslate"><span class="pre">(kernel_size,</span> <span class="pre">kernel_size)</span></code>.</p>
</p></li>
<li><p><strong>stride</strong> (<em>int</em>) – <p>Stride used in <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.Unfold.html#torch.nn.Unfold">torch.nn.Unfold</a>.</p>
</p></li>
<li><p><strong>padding</strong> (<em>int</em>) – <p>Padding used in <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.Unfold.html#torch.nn.Unfold">torch.nn.Unfold</a>.
If given as an <code class="docutils literal notranslate"><span class="pre">int</span></code>, the actual kernel size will be
<code class="docutils literal notranslate"><span class="pre">(kernel_size,</span> <span class="pre">kernel_size)</span></code>.</p>
</p></li>
<li><p><strong>dilation</strong> (<em>int</em>) – <p>Dilation used in <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.Unfold.html#torch.nn.Unfold">torch.nn.Unfold</a>.
If given as an <code class="docutils literal notranslate"><span class="pre">int</span></code>, the actual kernel size will be
<code class="docutils literal notranslate"><span class="pre">(kernel_size,</span> <span class="pre">kernel_size)</span></code>.</p>
</p></li>
<li><p><strong>boundary</strong> (<em>{&quot;obc&quot;</em><em>, </em><em>&quot;pbc&quot;}</em>) – String indicating whether periodic or open boundary conditions should
be used.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">conv_mps</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">ConvMPS</span><span class="p">(</span><span class="n">in_channels</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
<span class="gp">... </span>                             <span class="n">bond_dim</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
<span class="gp">... </span>                             <span class="n">kernel_size</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="c1"># batch_size x in_channels x height x width</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">conv_mps</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">torch.Size([20, 1, 1])</span>
</pre></div>
</div>
<dl class="py property">
<dt class="sig sig-object py" id="tensorkrowch.models.ConvMPS.in_channels">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">in_channels</span></span><a class="headerlink" href="#tensorkrowch.models.ConvMPS.in_channels" title="Permalink to this definition">#</a></dt>
<dd><p>Returns <code class="docutils literal notranslate"><span class="pre">in_channels</span></code>. Same as <code class="docutils literal notranslate"><span class="pre">in_dim</span></code> in <a class="reference internal" href="#tensorkrowch.models.MPS" title="tensorkrowch.models.MPS"><code class="xref py py-class docutils literal notranslate"><span class="pre">MPS</span></code></a>.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tensorkrowch.models.ConvMPS.kernel_size">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">kernel_size</span></span><a class="headerlink" href="#tensorkrowch.models.ConvMPS.kernel_size" title="Permalink to this definition">#</a></dt>
<dd><p>Returns <code class="docutils literal notranslate"><span class="pre">kernel_size</span></code>. Number of nodes is given by
<span class="math notranslate nohighlight">\(kernel\_size_0 \cdot kernel\_size_1\)</span>.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tensorkrowch.models.ConvMPS.stride">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">stride</span></span><a class="headerlink" href="#tensorkrowch.models.ConvMPS.stride" title="Permalink to this definition">#</a></dt>
<dd><p>Returns stride used in <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.Unfold.html#torch.nn.Unfold">torch.nn.Unfold</a>.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tensorkrowch.models.ConvMPS.padding">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">padding</span></span><a class="headerlink" href="#tensorkrowch.models.ConvMPS.padding" title="Permalink to this definition">#</a></dt>
<dd><p>Returns padding used in <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.Unfold.html#torch.nn.Unfold">torch.nn.Unfold</a>.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tensorkrowch.models.ConvMPS.dilation">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dilation</span></span><a class="headerlink" href="#tensorkrowch.models.ConvMPS.dilation" title="Permalink to this definition">#</a></dt>
<dd><p>Returns dilation used in <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.Unfold.html#torch.nn.Unfold">torch.nn.Unfold</a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensorkrowch.models.ConvMPS.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'flat'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tensorkrowch/models/mps.html#ConvMPS.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensorkrowch.models.ConvMPS.forward" title="Permalink to this definition">#</a></dt>
<dd><p>Overrides <code class="docutils literal notranslate"><span class="pre">torch.nn.Module</span></code>’s forward to compute a convolution on the
input image.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image</strong> (<em>torch.Tensor</em>) – <p>Input batch of images with shape</p>
<div class="math notranslate nohighlight">
\[batch\_size \times in\_channels \times height \times width\]</div>
</p></li>
<li><p><strong>mode</strong> (<em>{&quot;flat&quot;</em><em>, </em><em>&quot;snake&quot;}</em>) – Indicates the order in which MPS should take the pixels in the image.
When <code class="docutils literal notranslate"><span class="pre">&quot;flat&quot;</span></code>, the image is flattened putting one row of the image
after the other. When <code class="docutils literal notranslate"><span class="pre">&quot;snake&quot;</span></code>, its row is put in the opposite
orientation as the previous row (like a snake running through the
image).</p></li>
<li><p><strong>args</strong> – Arguments that might be used in <a class="reference internal" href="#tensorkrowch.models.MPS.contract" title="tensorkrowch.models.MPS.contract"><code class="xref py py-meth docutils literal notranslate"><span class="pre">contract()</span></code></a>.</p></li>
<li><p><strong>kwargs</strong> – Keyword arguments that might be used in <a class="reference internal" href="#tensorkrowch.models.MPS.contract" title="tensorkrowch.models.MPS.contract"><code class="xref py py-meth docutils literal notranslate"><span class="pre">contract()</span></code></a>,
like <code class="docutils literal notranslate"><span class="pre">inline_input</span></code> or <code class="docutils literal notranslate"><span class="pre">inline_mats</span></code>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="convumps">
<h3>ConvUMPS<a class="headerlink" href="#convumps" title="Permalink to this headline">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="tensorkrowch.models.ConvUMPS">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tensorkrowch.models.</span></span><span class="sig-name descname"><span class="pre">ConvUMPS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bond_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dilation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tensorkrowch/models/mps.html#ConvUMPS"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensorkrowch.models.ConvUMPS" title="Permalink to this definition">#</a></dt>
<dd><p>Class for Uniform Matrix Product States, where all nodes are input nodes,
and where the input data is a batch of images. It is the convolutional
version of <a class="reference internal" href="#tensorkrowch.models.UMPS" title="tensorkrowch.models.UMPS"><code class="xref py py-class docutils literal notranslate"><span class="pre">UMPS</span></code></a>. This class cannot have different bond dimensions
for each site and boundary conditions are always periodic.</p>
<p>Input data as well as initialization parameters are described in <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.Conv2d.html">torch.nn.Conv2d</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_channels</strong> (<em>int</em>) – Input channels. Same as <code class="docutils literal notranslate"><span class="pre">in_dim</span></code> in <a class="reference internal" href="#tensorkrowch.models.UMPS" title="tensorkrowch.models.UMPS"><code class="xref py py-class docutils literal notranslate"><span class="pre">UMPS</span></code></a>.</p></li>
<li><p><strong>bond_dim</strong> (<em>int</em>) – Bond dimension.</p></li>
<li><p><strong>kernel_size</strong> (<em>int</em><em>, </em><em>list</em><em>[</em><em>int</em><em>] or </em><em>tuple</em><em>[</em><em>int</em><em>]</em>) – <p>Kernel size used in <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.Unfold.html#torch.nn.Unfold">torch.nn.Unfold</a>.
If given as an <code class="docutils literal notranslate"><span class="pre">int</span></code>, the actual kernel size will be
<code class="docutils literal notranslate"><span class="pre">(kernel_size,</span> <span class="pre">kernel_size)</span></code>.</p>
</p></li>
<li><p><strong>stride</strong> (<em>int</em>) – <p>Stride used in <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.Unfold.html#torch.nn.Unfold">torch.nn.Unfold</a>.</p>
</p></li>
<li><p><strong>padding</strong> (<em>int</em>) – <p>Padding used in <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.Unfold.html#torch.nn.Unfold">torch.nn.Unfold</a>.
If given as an <code class="docutils literal notranslate"><span class="pre">int</span></code>, the actual kernel size will be
<code class="docutils literal notranslate"><span class="pre">(kernel_size,</span> <span class="pre">kernel_size)</span></code>.</p>
</p></li>
<li><p><strong>dilation</strong> (<em>int</em>) – <p>Dilation used in <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.Unfold.html#torch.nn.Unfold">torch.nn.Unfold</a>.
If given as an <code class="docutils literal notranslate"><span class="pre">int</span></code>, the actual kernel size will be
<code class="docutils literal notranslate"><span class="pre">(kernel_size,</span> <span class="pre">kernel_size)</span></code>.</p>
</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">conv_mps</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">ConvMPS</span><span class="p">(</span><span class="n">in_channels</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
<span class="gp">... </span>                             <span class="n">bond_dim</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
<span class="gp">... </span>                             <span class="n">kernel_size</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">mps</span><span class="o">.</span><span class="n">mats_env</span><span class="p">:</span>
<span class="gp">... </span>    <span class="k">assert</span> <span class="n">node</span><span class="o">.</span><span class="n">tensor_address</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;virtual_uniform&#39;</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="c1"># batch_size x in_channels x height x width</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">conv_mps</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">torch.Size([20, 1, 1])</span>
</pre></div>
</div>
<dl class="py property">
<dt class="sig sig-object py" id="tensorkrowch.models.ConvUMPS.in_channels">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">in_channels</span></span><a class="headerlink" href="#tensorkrowch.models.ConvUMPS.in_channels" title="Permalink to this definition">#</a></dt>
<dd><p>Returns <code class="docutils literal notranslate"><span class="pre">in_channels</span></code>. Same as <code class="docutils literal notranslate"><span class="pre">in_dim</span></code> in <a class="reference internal" href="#tensorkrowch.models.UMPS" title="tensorkrowch.models.UMPS"><code class="xref py py-class docutils literal notranslate"><span class="pre">UMPS</span></code></a>.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tensorkrowch.models.ConvUMPS.kernel_size">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">kernel_size</span></span><a class="headerlink" href="#tensorkrowch.models.ConvUMPS.kernel_size" title="Permalink to this definition">#</a></dt>
<dd><p>Returns <code class="docutils literal notranslate"><span class="pre">kernel_size</span></code>. Number of nodes is given by
<span class="math notranslate nohighlight">\(kernel\_size_0 \cdot kernel\_size_1\)</span>.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tensorkrowch.models.ConvUMPS.stride">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">stride</span></span><a class="headerlink" href="#tensorkrowch.models.ConvUMPS.stride" title="Permalink to this definition">#</a></dt>
<dd><p>Returns stride used in <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.Unfold.html#torch.nn.Unfold">torch.nn.Unfold</a>.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tensorkrowch.models.ConvUMPS.padding">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">padding</span></span><a class="headerlink" href="#tensorkrowch.models.ConvUMPS.padding" title="Permalink to this definition">#</a></dt>
<dd><p>Returns padding used in <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.Unfold.html#torch.nn.Unfold">torch.nn.Unfold</a>.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tensorkrowch.models.ConvUMPS.dilation">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dilation</span></span><a class="headerlink" href="#tensorkrowch.models.ConvUMPS.dilation" title="Permalink to this definition">#</a></dt>
<dd><p>Returns dilation used in <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.Unfold.html#torch.nn.Unfold">torch.nn.Unfold</a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensorkrowch.models.ConvUMPS.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'flat'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tensorkrowch/models/mps.html#ConvUMPS.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensorkrowch.models.ConvUMPS.forward" title="Permalink to this definition">#</a></dt>
<dd><p>Overrides <code class="docutils literal notranslate"><span class="pre">torch.nn.Module</span></code>’s forward to compute a convolution on the
input image.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image</strong> (<em>torch.Tensor</em>) – <p>Input batch of images with shape</p>
<div class="math notranslate nohighlight">
\[batch\_size \times in\_channels \times height \times width\]</div>
</p></li>
<li><p><strong>mode</strong> (<em>{&quot;flat&quot;</em><em>, </em><em>&quot;snake&quot;}</em>) – Indicates the order in which MPS should take the pixels in the image.
When <code class="docutils literal notranslate"><span class="pre">&quot;flat&quot;</span></code>, the image is flattened putting one row of the image
after the other. When <code class="docutils literal notranslate"><span class="pre">&quot;snake&quot;</span></code>, its row is put in the opposite
orientation as the previous row (like a snake running through the
image).</p></li>
<li><p><strong>args</strong> – Arguments that might be used in <a class="reference internal" href="#tensorkrowch.models.UMPS.contract" title="tensorkrowch.models.UMPS.contract"><code class="xref py py-meth docutils literal notranslate"><span class="pre">contract()</span></code></a>.</p></li>
<li><p><strong>kwargs</strong> – Keyword arguments that might be used in <a class="reference internal" href="#tensorkrowch.models.UMPS.contract" title="tensorkrowch.models.UMPS.contract"><code class="xref py py-meth docutils literal notranslate"><span class="pre">contract()</span></code></a>,
like <code class="docutils literal notranslate"><span class="pre">inline_input</span></code> or <code class="docutils literal notranslate"><span class="pre">inline_mats</span></code>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
</section>
<section id="tree">
<h2>Tree<a class="headerlink" href="#tree" title="Permalink to this headline">#</a></h2>
<section id="id34">
<h3>Tree<a class="headerlink" href="#id34" title="Permalink to this headline">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="tensorkrowch.models.Tree">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tensorkrowch.models.</span></span><span class="sig-name descname"><span class="pre">Tree</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sites_per_layer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bond_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_batches</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tensorkrowch/models/tree.html#Tree"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensorkrowch.models.Tree" title="Permalink to this definition">#</a></dt>
<dd><p>Class for Tree States. These states form a tree structure where the <code class="docutils literal notranslate"><span class="pre">data</span></code>
nodes are in the base. All nodes have a sequence of input edges and an
output edge. Thus the contraction of the Tree returns a <cite>vector</cite> node.</p>
<p>All nodes in the network are in <code class="docutils literal notranslate"><span class="pre">self.layers</span></code>, a list containing the lists
of nodes in each layer (starting from the bottom).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sites_per_layer</strong> (<em>list</em><em>[</em><em>int</em><em>] or </em><em>tuple</em><em>[</em><em>int</em><em>]</em>) – Number of sites in each layer of the tree. All nodes in the same layer
have the same shape. Number of nodes in each layer times the number of
input edges these have should match the number ot output edges in the
previous layer. The last element of <code class="docutils literal notranslate"><span class="pre">sites_per_layer</span></code> should be always
1, which corresponds to the output node.</p></li>
<li><p><strong>bond_dim</strong> (<em>list</em><em>[</em><em>list</em><em>[</em><em>int</em><em>]</em><em>] or </em><em>tuple</em><em>[</em><em>tuple</em><em>[</em><em>int</em><em>]</em><em>]</em>) – Bond dimensions of nodes in each layer. Each sequence corresponds to the
shape of the nodes in each layer, starting from the bottom (some input
edges and an output edge in the last position).</p></li>
<li><p><strong>n_batches</strong> (<em>int</em>) – Number of batch edges of input <code class="docutils literal notranslate"><span class="pre">data</span></code> nodes. Usually <code class="docutils literal notranslate"><span class="pre">n_batches</span> <span class="pre">=</span> <span class="pre">1</span></code>
(where the batch edge is used for the data batched) but it could also
be <code class="docutils literal notranslate"><span class="pre">n_batches</span> <span class="pre">=</span> <span class="pre">2</span></code> (one edge for data batched, other edge for image
patches in convolutional layers).</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">tree</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">Tree</span><span class="p">(</span><span class="n">sites_per_layer</span><span class="o">=</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="gp">... </span>                      <span class="n">bond_dim</span><span class="o">=</span><span class="p">[[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="c1"># batch_size x n_features x feature_size</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">tree</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span><span class="o">.</span><span class="n">shape</span>
<span class="go">torch.Size([20, 2])</span>
</pre></div>
</div>
<dl class="py property">
<dt class="sig sig-object py" id="tensorkrowch.models.Tree.sites_per_layer">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">sites_per_layer</span></span><a class="headerlink" href="#tensorkrowch.models.Tree.sites_per_layer" title="Permalink to this definition">#</a></dt>
<dd><p>Returns number of sites in each layer of the tree.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tensorkrowch.models.Tree.bond_dim">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">bond_dim</span></span><a class="headerlink" href="#tensorkrowch.models.Tree.bond_dim" title="Permalink to this definition">#</a></dt>
<dd><p>Returns bond dimensions of nodes in each layer. Each sequence
corresponds to the shape of the nodes in each layer (some input edges
and an output edge in the last position).</p>
<p>It can have two forms:</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">[shape_all_nodes_layer_1,</span> <span class="pre">...,</span> <span class="pre">shape_all_nodes_layer_N]</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">[[shape_node_1_layer_1,</span> <span class="pre">...,</span> <span class="pre">shape_node_i1_layer_1],</span> <span class="pre">...,</span>
<span class="pre">[shape_node_1_layer_N,</span> <span class="pre">...,</span> <span class="pre">shape_node_iN_layer_N]]</span></code></p></li>
</ol>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tensorkrowch.models.Tree.n_batches">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">n_batches</span></span><a class="headerlink" href="#tensorkrowch.models.Tree.n_batches" title="Permalink to this definition">#</a></dt>
<dd><p>Returns number of batch edges of the <code class="docutils literal notranslate"><span class="pre">data</span></code> nodes.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensorkrowch.models.Tree.initialize">
<span class="sig-name descname"><span class="pre">initialize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">std</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-09</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tensorkrowch/models/tree.html#Tree.initialize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensorkrowch.models.Tree.initialize" title="Permalink to this definition">#</a></dt>
<dd><p>Initializes all the nodes.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensorkrowch.models.Tree.set_data_nodes">
<span class="sig-name descname"><span class="pre">set_data_nodes</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tensorkrowch/models/tree.html#Tree.set_data_nodes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensorkrowch.models.Tree.set_data_nodes" title="Permalink to this definition">#</a></dt>
<dd><p>Creates data nodes and connects each of them to the physical edge of
an input node.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensorkrowch.models.Tree.contract">
<span class="sig-name descname"><span class="pre">contract</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inline</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tensorkrowch/models/tree.html#Tree.contract"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensorkrowch.models.Tree.contract" title="Permalink to this definition">#</a></dt>
<dd><p>Contracts the whole Tree Tensor Network.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>inline</strong> (<em>bool</em>) – Boolean indicating whether consecutive layers should be contracted
inline or in parallel (using a single stacked contraction).</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="components.html#tensorkrowch.Node" title="tensorkrowch.Node">Node</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensorkrowch.models.Tree.canonicalize">
<span class="sig-name descname"><span class="pre">canonicalize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'svd'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rank</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cum_percentage</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tensorkrowch/models/tree.html#Tree.canonicalize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensorkrowch.models.Tree.canonicalize" title="Permalink to this definition">#</a></dt>
<dd><p>Turns Tree into canonical form via local SVD/QR decompositions, moving
singular values matrices or non-isometries to the upper layers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mode</strong> (<em>{&quot;svd&quot;</em><em>, </em><em>&quot;svdr&quot;</em><em>, </em><em>&quot;qr&quot;}</em>) – Indicates which decomposition should be used to split a node after
contracting it. See more at <code class="xref py py-func docutils literal notranslate"><span class="pre">svd_()</span></code>, <code class="xref py py-func docutils literal notranslate"><span class="pre">svdr_()</span></code>, <code class="xref py py-func docutils literal notranslate"><span class="pre">qr_()</span></code>.
If mode is “qr”, operation <code class="xref py py-func docutils literal notranslate"><span class="pre">qr_()</span></code> will be performed on nodes at
the left of the output node, whilst operation <code class="xref py py-func docutils literal notranslate"><span class="pre">rq_()</span></code> will be
used for nodes at the right.</p></li>
<li><p><strong>rank</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of singular values to keep.</p></li>
<li><p><strong>cum_percentage</strong> (<em>float</em><em>, </em><em>optional</em>) – <p>Proportion that should be satisfied between the sum of all singular
values kept and the total sum of all singular values.</p>
<div class="math notranslate nohighlight">
\[\frac{\sum_{i \in \{kept\}}{s_i}}{\sum_{i \in \{all\}}{s_i}} \ge
cum\_percentage\]</div>
</p></li>
<li><p><strong>cutoff</strong> (<em>float</em><em>, </em><em>optional</em>) – Quantity that lower bounds singular values in order to be kept.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">tree</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">Tree</span><span class="p">(</span><span class="n">sites_per_layer</span><span class="o">=</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="gp">... </span>                      <span class="n">bond_dim</span><span class="o">=</span><span class="p">[[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tree</span><span class="o">.</span><span class="n">canonicalize</span><span class="p">(</span><span class="n">rank</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tree</span><span class="o">.</span><span class="n">bond_dim</span>
<span class="go">[[[3, 3, 2], [3, 3, 2], [3, 3, 2], [3, 3, 2]], [[2, 2, 2], [2, 2, 2]], [[2, 2, 2]]]</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</section>
<section id="utree">
<h3>UTree<a class="headerlink" href="#utree" title="Permalink to this headline">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="tensorkrowch.models.UTree">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tensorkrowch.models.</span></span><span class="sig-name descname"><span class="pre">UTree</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sites_per_layer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bond_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_batches</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tensorkrowch/models/tree.html#UTree"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensorkrowch.models.UTree" title="Permalink to this definition">#</a></dt>
<dd><p>Class for Uniform Tree States where all nodes have the same shape. It is
the uniform version of <a class="reference internal" href="#tensorkrowch.models.Tree" title="tensorkrowch.models.Tree"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tree</span></code></a>, that is, all nodes share the same
tensor.</p>
<p>All nodes in the network are in <code class="docutils literal notranslate"><span class="pre">self.layers</span></code>, a list containing the lists
of nodes in each layer (starting from the bottom).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sites_per_layer</strong> (<em>list</em><em>[</em><em>int</em><em>] or </em><em>tuple</em><em>[</em><em>int</em><em>]</em>) – Number of sites in each layer of the tree. All nodes have the same
shape. Number of nodes in each layer times the number of input edges
these have should match the number ot output edges in the previous
layer. The last element of <code class="docutils literal notranslate"><span class="pre">sites_per_layer</span></code> should be always 1,
which corresponds to the output node.</p></li>
<li><p><strong>bond_dim</strong> (<em>list</em><em>[</em><em>int</em><em>] or </em><em>tuple</em><em>[</em><em>int</em><em>]</em>) – Bond dimensions of nodes in each layer. Since all nodes have the same
shape, it is enough to pass a single sequence of dimensions (some input
edges and an output edge in the last position).</p></li>
<li><p><strong>n_batches</strong> (<em>int</em>) – Number of batch edges of input <code class="docutils literal notranslate"><span class="pre">data</span></code> nodes. Usually <code class="docutils literal notranslate"><span class="pre">n_batches</span> <span class="pre">=</span> <span class="pre">1</span></code>
(where the batch edge is used for the data batched) but it could also
be <code class="docutils literal notranslate"><span class="pre">n_batches</span> <span class="pre">=</span> <span class="pre">2</span></code> (one edge for data batched, other edge for image
patches in convolutional layers).</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">tree</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">UTree</span><span class="p">(</span><span class="n">sites_per_layer</span><span class="o">=</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="gp">... </span>                       <span class="n">bond_dim</span><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">layer</span> <span class="ow">in</span> <span class="n">tree</span><span class="o">.</span><span class="n">layers</span><span class="p">:</span>
<span class="gp">... </span>    <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">layer</span><span class="p">:</span>
<span class="gp">... </span>        <span class="k">assert</span> <span class="n">node</span><span class="o">.</span><span class="n">tensor_address</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;virtual_uniform&#39;</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="c1"># batch_size x n_features x feature_size</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">tree</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span><span class="o">.</span><span class="n">shape</span>
<span class="go">torch.Size([20, 3])</span>
</pre></div>
</div>
<dl class="py property">
<dt class="sig sig-object py" id="tensorkrowch.models.UTree.sites_per_layer">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">sites_per_layer</span></span><a class="headerlink" href="#tensorkrowch.models.UTree.sites_per_layer" title="Permalink to this definition">#</a></dt>
<dd><p>Returns number of sites in each layer of the tree.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tensorkrowch.models.UTree.bond_dim">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">bond_dim</span></span><a class="headerlink" href="#tensorkrowch.models.UTree.bond_dim" title="Permalink to this definition">#</a></dt>
<dd><p>Returns bond dimensions of nodes in each layer. Since all nodes have
the same shape, it is a single sequence of dimensions (some input edges
and an output edge in the last position).</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tensorkrowch.models.UTree.n_batches">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">n_batches</span></span><a class="headerlink" href="#tensorkrowch.models.UTree.n_batches" title="Permalink to this definition">#</a></dt>
<dd><p>Returns number of batch edges of the <code class="docutils literal notranslate"><span class="pre">data</span></code> nodes.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensorkrowch.models.UTree.initialize">
<span class="sig-name descname"><span class="pre">initialize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">std</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-09</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tensorkrowch/models/tree.html#UTree.initialize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensorkrowch.models.UTree.initialize" title="Permalink to this definition">#</a></dt>
<dd><p>Initializes all the nodes.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensorkrowch.models.UTree.set_data_nodes">
<span class="sig-name descname"><span class="pre">set_data_nodes</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tensorkrowch/models/tree.html#UTree.set_data_nodes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensorkrowch.models.UTree.set_data_nodes" title="Permalink to this definition">#</a></dt>
<dd><p>Creates data nodes and connects each of them to the physical edge of
an input node.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensorkrowch.models.UTree.contract">
<span class="sig-name descname"><span class="pre">contract</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inline</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tensorkrowch/models/tree.html#UTree.contract"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensorkrowch.models.UTree.contract" title="Permalink to this definition">#</a></dt>
<dd><p>Contracts the whole Tree Tensor Network.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>inline</strong> (<em>bool</em>) – Boolean indicating whether consecutive layers should be contracted
inline or in parallel (using a single stacked contraction).</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="components.html#tensorkrowch.Node" title="tensorkrowch.Node">Node</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="convtree">
<h3>ConvTree<a class="headerlink" href="#convtree" title="Permalink to this headline">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="tensorkrowch.models.ConvTree">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tensorkrowch.models.</span></span><span class="sig-name descname"><span class="pre">ConvTree</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sites_per_layer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bond_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dilation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tensorkrowch/models/tree.html#ConvTree"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensorkrowch.models.ConvTree" title="Permalink to this definition">#</a></dt>
<dd><p>Class for Tree States where the input data is a batch of images. It is the
convolutional version of <a class="reference internal" href="#tensorkrowch.models.Tree" title="tensorkrowch.models.Tree"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tree</span></code></a>.</p>
<p>Input data as well as initialization parameters are described in <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.Conv2d.html">torch.nn.Conv2d</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sites_per_layer</strong> (<em>list</em><em>[</em><em>int</em><em>] or </em><em>tuple</em><em>[</em><em>int</em><em>]</em>) – Number of sites in each layer of the tree. All nodes in the same layer
have the same shape. Number of nodes in each layer times the number of
input edges these have should match the number ot output edges in the
previous layer.</p></li>
<li><p><strong>bond_dim</strong> (<em>list</em><em>[</em><em>list</em><em>[</em><em>int</em><em>]</em><em>] or </em><em>tuple</em><em>[</em><em>tuple</em><em>[</em><em>int</em><em>]</em><em>]</em>) – Bond dimensions of nodes in each layer. Each sequence corresponds to the
shape of the nodes in each layer (some input edges and an output edge in
the last position).</p></li>
<li><p><strong>kernel_size</strong> (<em>int</em><em>, </em><em>list</em><em>[</em><em>int</em><em>] or </em><em>tuple</em><em>[</em><em>int</em><em>]</em>) – <p>Kernel size used in <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.Unfold.html#torch.nn.Unfold">torch.nn.Unfold</a>.
If given as an <code class="docutils literal notranslate"><span class="pre">int</span></code>, the actual kernel size will be
<code class="docutils literal notranslate"><span class="pre">(kernel_size,</span> <span class="pre">kernel_size)</span></code>.</p>
</p></li>
<li><p><strong>stride</strong> (<em>int</em>) – <p>Stride used in <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.Unfold.html#torch.nn.Unfold">torch.nn.Unfold</a>.</p>
</p></li>
<li><p><strong>padding</strong> (<em>int</em>) – <p>Padding used in <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.Unfold.html#torch.nn.Unfold">torch.nn.Unfold</a>.
If given as an <code class="docutils literal notranslate"><span class="pre">int</span></code>, the actual kernel size will be
<code class="docutils literal notranslate"><span class="pre">(kernel_size,</span> <span class="pre">kernel_size)</span></code>.</p>
</p></li>
<li><p><strong>dilation</strong> (<em>int</em>) – <p>Dilation used in <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.Unfold.html#torch.nn.Unfold">torch.nn.Unfold</a>.
If given as an <code class="docutils literal notranslate"><span class="pre">int</span></code>, the actual kernel size will be
<code class="docutils literal notranslate"><span class="pre">(kernel_size,</span> <span class="pre">kernel_size)</span></code>.</p>
</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">conv_tree</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">ConvTree</span><span class="p">(</span><span class="n">sites_per_layer</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="gp">... </span>                               <span class="n">bond_dim</span><span class="o">=</span><span class="p">[[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">]],</span>
<span class="gp">... </span>                               <span class="n">kernel_size</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="c1"># batch_size x in_channels x height x width</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">conv_tree</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">torch.Size([20, 5, 1, 1])</span>
</pre></div>
</div>
<dl class="py property">
<dt class="sig sig-object py" id="tensorkrowch.models.ConvTree.in_channels">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">in_channels</span></span><a class="headerlink" href="#tensorkrowch.models.ConvTree.in_channels" title="Permalink to this definition">#</a></dt>
<dd><p>Returns <code class="docutils literal notranslate"><span class="pre">in_channels</span></code>. Same as the first elements in <code class="docutils literal notranslate"><span class="pre">bond_dim</span></code>
from <a class="reference internal" href="#tensorkrowch.models.Tree" title="tensorkrowch.models.Tree"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tree</span></code></a>, corresponding to dimensions of the input.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tensorkrowch.models.ConvTree.kernel_size">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">kernel_size</span></span><a class="headerlink" href="#tensorkrowch.models.ConvTree.kernel_size" title="Permalink to this definition">#</a></dt>
<dd><p>Returns <code class="docutils literal notranslate"><span class="pre">kernel_size</span></code>, corresponding to number of <code class="docutils literal notranslate"><span class="pre">data</span></code> nodes.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tensorkrowch.models.ConvTree.stride">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">stride</span></span><a class="headerlink" href="#tensorkrowch.models.ConvTree.stride" title="Permalink to this definition">#</a></dt>
<dd><p>Returns stride used in <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.Unfold.html#torch.nn.Unfold">torch.nn.Unfold</a>.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tensorkrowch.models.ConvTree.padding">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">padding</span></span><a class="headerlink" href="#tensorkrowch.models.ConvTree.padding" title="Permalink to this definition">#</a></dt>
<dd><p>Returns padding used in <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.Unfold.html#torch.nn.Unfold">torch.nn.Unfold</a>.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tensorkrowch.models.ConvTree.dilation">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dilation</span></span><a class="headerlink" href="#tensorkrowch.models.ConvTree.dilation" title="Permalink to this definition">#</a></dt>
<dd><p>Returns dilation used in <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.Unfold.html#torch.nn.Unfold">torch.nn.Unfold</a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensorkrowch.models.ConvTree.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tensorkrowch/models/tree.html#ConvTree.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensorkrowch.models.ConvTree.forward" title="Permalink to this definition">#</a></dt>
<dd><p>Overrides <code class="docutils literal notranslate"><span class="pre">torch.nn.Module</span></code>’s forward to compute a convolution on the
input image.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image</strong> (<em>torch.Tensor</em>) – <p>Input batch of images with shape</p>
<div class="math notranslate nohighlight">
\[batch\_size \times in\_channels \times height \times width\]</div>
</p></li>
<li><p><strong>args</strong> – Arguments that might be used in <a class="reference internal" href="#tensorkrowch.models.Tree.contract" title="tensorkrowch.models.Tree.contract"><code class="xref py py-meth docutils literal notranslate"><span class="pre">contract()</span></code></a>.</p></li>
<li><p><strong>kwargs</strong> – Keyword arguments that might be used in <a class="reference internal" href="#tensorkrowch.models.Tree.contract" title="tensorkrowch.models.Tree.contract"><code class="xref py py-meth docutils literal notranslate"><span class="pre">contract()</span></code></a>,
like <code class="docutils literal notranslate"><span class="pre">inline</span></code>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="convutree">
<h3>ConvUTree<a class="headerlink" href="#convutree" title="Permalink to this headline">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="tensorkrowch.models.ConvUTree">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tensorkrowch.models.</span></span><span class="sig-name descname"><span class="pre">ConvUTree</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sites_per_layer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bond_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dilation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tensorkrowch/models/tree.html#ConvUTree"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensorkrowch.models.ConvUTree" title="Permalink to this definition">#</a></dt>
<dd><p>Class for Uniform Tree States where the input data is a batch of images. It
is the convolutional version of <a class="reference internal" href="#tensorkrowch.models.UTree" title="tensorkrowch.models.UTree"><code class="xref py py-class docutils literal notranslate"><span class="pre">UTree</span></code></a>.</p>
<p>Input data as well as initialization parameters are described in <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.Conv2d.html">torch.nn.Conv2d</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sites_per_layer</strong> (<em>list</em><em>[</em><em>int</em><em>] or </em><em>tuple</em><em>[</em><em>int</em><em>]</em>) – Number of sites in each layer of the tree. All nodes have the same
shape. Number of nodes in each layer times the number of input edges
these have should match the number ot output edges in the previous
layer.</p></li>
<li><p><strong>bond_dim</strong> (<em>list</em><em>[</em><em>int</em><em>] or </em><em>tuple</em><em>[</em><em>int</em><em>]</em>) – Bond dimensions of nodes in each layer. Since all nodes have the same
shape, it is enough to pass a single sequence of dimensions (some input
edges and an output edge in the last position).</p></li>
<li><p><strong>kernel_size</strong> (<em>int</em><em>, </em><em>list</em><em>[</em><em>int</em><em>] or </em><em>tuple</em><em>[</em><em>int</em><em>]</em>) – <p>Kernel size used in <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.Unfold.html#torch.nn.Unfold">torch.nn.Unfold</a>.
If given as an <code class="docutils literal notranslate"><span class="pre">int</span></code>, the actual kernel size will be
<code class="docutils literal notranslate"><span class="pre">(kernel_size,</span> <span class="pre">kernel_size)</span></code>.</p>
</p></li>
<li><p><strong>stride</strong> (<em>int</em>) – <p>Stride used in <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.Unfold.html#torch.nn.Unfold">torch.nn.Unfold</a>.</p>
</p></li>
<li><p><strong>padding</strong> (<em>int</em>) – <p>Padding used in <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.Unfold.html#torch.nn.Unfold">torch.nn.Unfold</a>.
If given as an <code class="docutils literal notranslate"><span class="pre">int</span></code>, the actual kernel size will be
<code class="docutils literal notranslate"><span class="pre">(kernel_size,</span> <span class="pre">kernel_size)</span></code>.</p>
</p></li>
<li><p><strong>dilation</strong> (<em>int</em>) – <p>Dilation used in <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.Unfold.html#torch.nn.Unfold">torch.nn.Unfold</a>.
If given as an <code class="docutils literal notranslate"><span class="pre">int</span></code>, the actual kernel size will be
<code class="docutils literal notranslate"><span class="pre">(kernel_size,</span> <span class="pre">kernel_size)</span></code>.</p>
</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">conv_tree</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">ConvUTree</span><span class="p">(</span><span class="n">sites_per_layer</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="gp">... </span>                                <span class="n">bond_dim</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
<span class="gp">... </span>                                <span class="n">kernel_size</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">layer</span> <span class="ow">in</span> <span class="n">conv_tree</span><span class="o">.</span><span class="n">layers</span><span class="p">:</span>
<span class="gp">... </span>    <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">layer</span><span class="p">:</span>
<span class="gp">... </span>        <span class="k">assert</span> <span class="n">node</span><span class="o">.</span><span class="n">tensor_address</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;virtual_uniform&#39;</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="c1"># batch_size x in_channels x height x width</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">conv_tree</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">torch.Size([20, 2, 1, 1])</span>
</pre></div>
</div>
<dl class="py property">
<dt class="sig sig-object py" id="tensorkrowch.models.ConvUTree.in_channels">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">in_channels</span></span><a class="headerlink" href="#tensorkrowch.models.ConvUTree.in_channels" title="Permalink to this definition">#</a></dt>
<dd><p>Returns <code class="docutils literal notranslate"><span class="pre">in_channels</span></code>. Same as the first elements in <code class="docutils literal notranslate"><span class="pre">bond_dim</span></code>
from <a class="reference internal" href="#tensorkrowch.models.UTree" title="tensorkrowch.models.UTree"><code class="xref py py-class docutils literal notranslate"><span class="pre">UTree</span></code></a>, corresponding to dimensions of the input.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tensorkrowch.models.ConvUTree.kernel_size">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">kernel_size</span></span><a class="headerlink" href="#tensorkrowch.models.ConvUTree.kernel_size" title="Permalink to this definition">#</a></dt>
<dd><p>Returns <code class="docutils literal notranslate"><span class="pre">kernel_size</span></code>, corresponding to number of <code class="docutils literal notranslate"><span class="pre">data</span></code> nodes.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tensorkrowch.models.ConvUTree.stride">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">stride</span></span><a class="headerlink" href="#tensorkrowch.models.ConvUTree.stride" title="Permalink to this definition">#</a></dt>
<dd><p>Returns stride used in <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.Unfold.html#torch.nn.Unfold">torch.nn.Unfold</a>.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tensorkrowch.models.ConvUTree.padding">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">padding</span></span><a class="headerlink" href="#tensorkrowch.models.ConvUTree.padding" title="Permalink to this definition">#</a></dt>
<dd><p>Returns padding used in <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.Unfold.html#torch.nn.Unfold">torch.nn.Unfold</a>.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tensorkrowch.models.ConvUTree.dilation">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dilation</span></span><a class="headerlink" href="#tensorkrowch.models.ConvUTree.dilation" title="Permalink to this definition">#</a></dt>
<dd><p>Returns dilation used in <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.Unfold.html#torch.nn.Unfold">torch.nn.Unfold</a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensorkrowch.models.ConvUTree.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tensorkrowch/models/tree.html#ConvUTree.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensorkrowch.models.ConvUTree.forward" title="Permalink to this definition">#</a></dt>
<dd><p>Overrides <code class="docutils literal notranslate"><span class="pre">torch.nn.Module</span></code>’s forward to compute a convolution on the
input image.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image</strong> (<em>torch.Tensor</em>) – <p>Input batch of images with shape</p>
<div class="math notranslate nohighlight">
\[batch\_size \times in\_channels \times height \times width\]</div>
</p></li>
<li><p><strong>args</strong> – Arguments that might be used in <a class="reference internal" href="#tensorkrowch.models.UTree.contract" title="tensorkrowch.models.UTree.contract"><code class="xref py py-meth docutils literal notranslate"><span class="pre">contract()</span></code></a>.</p></li>
<li><p><strong>kwargs</strong> – Keyword arguments that might be used in <a class="reference internal" href="#tensorkrowch.models.UTree.contract" title="tensorkrowch.models.UTree.contract"><code class="xref py py-meth docutils literal notranslate"><span class="pre">contract()</span></code></a>,
like <code class="docutils literal notranslate"><span class="pre">inline</span></code>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
</section>
<section id="peps">
<h2>PEPS<a class="headerlink" href="#peps" title="Permalink to this headline">#</a></h2>
<section id="id51">
<h3>PEPS<a class="headerlink" href="#id51" title="Permalink to this headline">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="tensorkrowch.models.PEPS">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tensorkrowch.models.</span></span><span class="sig-name descname"><span class="pre">PEPS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_rows</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_cols</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bond_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boundary</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['obc',</span> <span class="pre">'obc']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_batches</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tensorkrowch/models/peps.html#PEPS"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensorkrowch.models.PEPS" title="Permalink to this definition">#</a></dt>
<dd><p>Class for Projected Entangled Pair States, where all nodes are input nodes,
that is, they are all connected to <code class="docutils literal notranslate"><span class="pre">data</span></code> nodes that will store the input
data tensor(s). When contracting the PEPS with new input data, the result
will be a just a number.</p>
<p>A <code class="docutils literal notranslate"><span class="pre">PEPS</span></code> is formed by the following nodes:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">left_up_corner</span></code>, <code class="docutils literal notranslate"><span class="pre">left_down_corner</span></code>, <code class="docutils literal notranslate"><span class="pre">right_up_corner</span></code>,
<code class="docutils literal notranslate"><span class="pre">right_down_corner</span></code>: Corner nodes with 3 edges, the one corresponding
to the input and 2 connected to the borders.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">left_border</span></code>, <code class="docutils literal notranslate"><span class="pre">right_border</span></code>, <code class="docutils literal notranslate"><span class="pre">up_border</span></code>, <code class="docutils literal notranslate"><span class="pre">down_border</span></code>: Border
nodes with 4 edges, the one corresponding to the input, 2 connected to
the neighbours in the border, and 1 connected to the <cite>interior</cite> of the
grid.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">grid_env</span></code>: Grid environment of nodes with 5 edges, (“input”, “left”,
“right”, “up”, “down”). Is is a list of lists of nodes.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_rows</strong> (<em>int</em>) – Number of rows of the 2D grid.</p></li>
<li><p><strong>n_cols</strong> (<em>int</em>) – Number of columns of the 2D grid.</p></li>
<li><p><strong>in_dim</strong> (<em>int</em>) – Input dimension.</p></li>
<li><p><strong>bond_dim</strong> (<em>list</em><em>[</em><em>int</em><em>] or </em><em>tuple</em><em>[</em><em>int</em><em>]</em>) – Bond dimensions for horizontal and vertical edges (in that order). Thus
it should contain 2 elements.</p></li>
<li><p><strong>boundary</strong> (<em>list</em><em>[</em><em>{&quot;obc&quot;</em><em>, </em><em>&quot;pbc&quot;}</em><em>]</em>) – List of strings indicating whether periodic or open boundary conditions
should be used in the horizontal (up and down) and vertical (left and
right) boundaries.</p></li>
<li><p><strong>n_batches</strong> (<em>int</em>) – Number of batch edges of input <code class="docutils literal notranslate"><span class="pre">data</span></code> nodes. Usually <code class="docutils literal notranslate"><span class="pre">n_batches</span> <span class="pre">=</span> <span class="pre">1</span></code>
(where the batch edge is used for the data batched) but it could also
be <code class="docutils literal notranslate"><span class="pre">n_batches</span> <span class="pre">=</span> <span class="pre">2</span></code> (one edge for data batched, other edge for image
patches in convolutional layers).</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">peps</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">PEPS</span><span class="p">(</span><span class="n">n_rows</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
<span class="gp">... </span>                      <span class="n">n_cols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
<span class="gp">... </span>                      <span class="n">in_dim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
<span class="gp">... </span>                      <span class="n">bond_dim</span><span class="o">=</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="c1"># batch_size x n_features x feature_size</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">peps</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span><span class="o">.</span><span class="n">shape</span>
<span class="go">torch.Size([20])</span>
</pre></div>
</div>
<dl class="py property">
<dt class="sig sig-object py" id="tensorkrowch.models.PEPS.n_rows">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">n_rows</span></span><a class="headerlink" href="#tensorkrowch.models.PEPS.n_rows" title="Permalink to this definition">#</a></dt>
<dd><p>Returns number of rows of the 2D grid.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tensorkrowch.models.PEPS.n_cols">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">n_cols</span></span><a class="headerlink" href="#tensorkrowch.models.PEPS.n_cols" title="Permalink to this definition">#</a></dt>
<dd><p>Returns number of columns of the 2D grid.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tensorkrowch.models.PEPS.boundary">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">boundary</span></span><a class="headerlink" href="#tensorkrowch.models.PEPS.boundary" title="Permalink to this definition">#</a></dt>
<dd><p>Returns boundary conditions in the horizontal (up and down) and
vertical (left and right) boundaries.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tensorkrowch.models.PEPS.in_dim">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">in_dim</span></span><a class="headerlink" href="#tensorkrowch.models.PEPS.in_dim" title="Permalink to this definition">#</a></dt>
<dd><p>Returns input dimension.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tensorkrowch.models.PEPS.bond_dim">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">bond_dim</span></span><a class="headerlink" href="#tensorkrowch.models.PEPS.bond_dim" title="Permalink to this definition">#</a></dt>
<dd><p>Returns bond dimensions for horizontal and vertical edges.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tensorkrowch.models.PEPS.n_batches">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">n_batches</span></span><a class="headerlink" href="#tensorkrowch.models.PEPS.n_batches" title="Permalink to this definition">#</a></dt>
<dd><p>Returns number of batch edges of the <code class="docutils literal notranslate"><span class="pre">data</span></code> nodes.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensorkrowch.models.PEPS.initialize">
<span class="sig-name descname"><span class="pre">initialize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">std</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-09</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tensorkrowch/models/peps.html#PEPS.initialize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensorkrowch.models.PEPS.initialize" title="Permalink to this definition">#</a></dt>
<dd><p>Initializes all the nodes.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensorkrowch.models.PEPS.set_data_nodes">
<span class="sig-name descname"><span class="pre">set_data_nodes</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tensorkrowch/models/peps.html#PEPS.set_data_nodes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensorkrowch.models.PEPS.set_data_nodes" title="Permalink to this definition">#</a></dt>
<dd><p>Creates data nodes and connects each of them to the physical edge of
an input node.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensorkrowch.models.PEPS.contract">
<span class="sig-name descname"><span class="pre">contract</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">from_side</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'up'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_bond</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inline</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tensorkrowch/models/peps.html#PEPS.contract"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensorkrowch.models.PEPS.contract" title="Permalink to this definition">#</a></dt>
<dd><p>Contracts the whole PEPS.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>from_side</strong> (<em>{&quot;up&quot;</em><em>, </em><em>&quot;down&quot;</em><em>, </em><em>&quot;left&quot;</em><em>, </em><em>&quot;right&quot;}</em>) – Indicates from which side of the 2D grid the contraction algorithm
should start.</p></li>
<li><p><strong>max_bond</strong> (<em>int</em>) – The maximum allowed bond dimension. If, when contracting consecutive
lines (rows or columns) of the PEPS this bond dimension is exceeded,
the bond dimension is reduced using singular value decomposition
(see <code class="xref py py-func docutils literal notranslate"><span class="pre">split()</span></code>).</p></li>
<li><p><strong>inline</strong> (<em>bool</em>) – Boolean indicating whether consecutive lines should be contracted
inline or in parallel (using a single stacked contraction).</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="components.html#tensorkrowch.Node" title="tensorkrowch.Node">Node</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="upeps">
<h3>UPEPS<a class="headerlink" href="#upeps" title="Permalink to this headline">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="tensorkrowch.models.UPEPS">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tensorkrowch.models.</span></span><span class="sig-name descname"><span class="pre">UPEPS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_rows</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_cols</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bond_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_batches</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tensorkrowch/models/peps.html#UPEPS"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensorkrowch.models.UPEPS" title="Permalink to this definition">#</a></dt>
<dd><p>Class for Uniform (translationally invariant) Projected Entangled Pair
States, where all nodes are input nodes. It is the uniform version of
<a class="reference internal" href="#tensorkrowch.models.PEPS" title="tensorkrowch.models.PEPS"><code class="xref py py-class docutils literal notranslate"><span class="pre">PEPS</span></code></a>, that is, all nodes share the same tensor. Thus boundary
conditions are always periodic.</p>
<p>A <code class="docutils literal notranslate"><span class="pre">UPEPS</span></code> is formed by the following nodes:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">grid_env</span></code>: Grid environment of nodes with 5 edges, (“input”, “left”,
“right”, “up”, “down”). Is is a list of lists of nodes.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_rows</strong> (<em>int</em>) – Number of rows of the 2D grid.</p></li>
<li><p><strong>n_cols</strong> (<em>int</em>) – Number of columns of the 2D grid</p></li>
<li><p><strong>in_dim</strong> (<em>int</em>) – Input dimension.</p></li>
<li><p><strong>bond_dim</strong> (<em>list</em><em>[</em><em>int</em><em>] or </em><em>tuple</em><em>[</em><em>int</em><em>]</em>) – Bond dimensions for horizontal and vertical edges (in that order). Thus
it should also contain 2 elements</p></li>
<li><p><strong>n_batches</strong> (<em>int</em>) – Number of batch edges of input <code class="docutils literal notranslate"><span class="pre">data</span></code> nodes. Usually <code class="docutils literal notranslate"><span class="pre">n_batches</span> <span class="pre">=</span> <span class="pre">1</span></code>
(where the batch edge is used for the data batched) but it could also
be <code class="docutils literal notranslate"><span class="pre">nu_batches</span> <span class="pre">=</span> <span class="pre">2</span></code> (one edge for data batched, other edge for image
patches in convolutional layers).</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">peps</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">PEPS</span><span class="p">(</span><span class="n">n_rows</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
<span class="gp">... </span>                      <span class="n">n_cols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
<span class="gp">... </span>                      <span class="n">in_dim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
<span class="gp">... </span>                      <span class="n">bond_dim</span><span class="o">=</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">peps</span><span class="o">.</span><span class="n">grid_env</span><span class="p">:</span>
<span class="gp">... </span>    <span class="k">assert</span> <span class="n">node</span><span class="o">.</span><span class="n">tensor_address</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;virtual_uniform&#39;</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="c1"># batch_size x n_features x feature_size</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">peps</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span><span class="o">.</span><span class="n">shape</span>
<span class="go">torch.Size([20])</span>
</pre></div>
</div>
<dl class="py property">
<dt class="sig sig-object py" id="tensorkrowch.models.UPEPS.n_rows">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">n_rows</span></span><a class="headerlink" href="#tensorkrowch.models.UPEPS.n_rows" title="Permalink to this definition">#</a></dt>
<dd><p>Returns number of rows of the 2D grid.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tensorkrowch.models.UPEPS.n_cols">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">n_cols</span></span><a class="headerlink" href="#tensorkrowch.models.UPEPS.n_cols" title="Permalink to this definition">#</a></dt>
<dd><p>Returns number of columns of the 2D grid.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tensorkrowch.models.UPEPS.in_dim">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">in_dim</span></span><a class="headerlink" href="#tensorkrowch.models.UPEPS.in_dim" title="Permalink to this definition">#</a></dt>
<dd><p>Returns input dimension.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tensorkrowch.models.UPEPS.bond_dim">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">bond_dim</span></span><a class="headerlink" href="#tensorkrowch.models.UPEPS.bond_dim" title="Permalink to this definition">#</a></dt>
<dd><p>Returns bond dimensions for horizontal and vertical edges.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tensorkrowch.models.UPEPS.n_batches">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">n_batches</span></span><a class="headerlink" href="#tensorkrowch.models.UPEPS.n_batches" title="Permalink to this definition">#</a></dt>
<dd><p>Returns number of batch edges of the <code class="docutils literal notranslate"><span class="pre">data</span></code> nodes.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensorkrowch.models.UPEPS.initialize">
<span class="sig-name descname"><span class="pre">initialize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">std</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-09</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tensorkrowch/models/peps.html#UPEPS.initialize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensorkrowch.models.UPEPS.initialize" title="Permalink to this definition">#</a></dt>
<dd><p>Initializes all the nodes.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensorkrowch.models.UPEPS.set_data_nodes">
<span class="sig-name descname"><span class="pre">set_data_nodes</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tensorkrowch/models/peps.html#UPEPS.set_data_nodes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensorkrowch.models.UPEPS.set_data_nodes" title="Permalink to this definition">#</a></dt>
<dd><p>Creates data nodes and connects each of them to the physical edge of
an input node.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensorkrowch.models.UPEPS.contract">
<span class="sig-name descname"><span class="pre">contract</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">from_side</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'up'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_bond</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inline</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tensorkrowch/models/peps.html#UPEPS.contract"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensorkrowch.models.UPEPS.contract" title="Permalink to this definition">#</a></dt>
<dd><p>Contracts the whole PEPS.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>from_side</strong> (<em>{&quot;up&quot;</em><em>, </em><em>&quot;down&quot;</em><em>, </em><em>&quot;left&quot;</em><em>, </em><em>&quot;right&quot;}</em>) – Indicates from which side of the 2D grid the contraction algorithm
should start.</p></li>
<li><p><strong>max_bond</strong> (<em>int</em>) – The maximum allowed bond dimension. If, when contracting consecutive
lines (rows or columns) of the PEPS this bond dimension is exceeded,
the bond dimension is reduced using singular value decomposition
(see <code class="xref py py-func docutils literal notranslate"><span class="pre">split()</span></code>).</p></li>
<li><p><strong>inline</strong> (<em>bool</em>) – Boolean indicating whether consecutive lines should be contracted
inline or in parallel (using a single stacked contraction).</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="components.html#tensorkrowch.Node" title="tensorkrowch.Node">Node</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="convpeps">
<h3>ConvPEPS<a class="headerlink" href="#convpeps" title="Permalink to this headline">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="tensorkrowch.models.ConvPEPS">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tensorkrowch.models.</span></span><span class="sig-name descname"><span class="pre">ConvPEPS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bond_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dilation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boundary</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['obc',</span> <span class="pre">'obc']</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tensorkrowch/models/peps.html#ConvPEPS"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensorkrowch.models.ConvPEPS" title="Permalink to this definition">#</a></dt>
<dd><p>Class for Projected Entangled Pair States, where all nodes are input nodes,
and where the input data is a batch of images. It is the convolutional
version of <a class="reference internal" href="#tensorkrowch.models.PEPS" title="tensorkrowch.models.PEPS"><code class="xref py py-class docutils literal notranslate"><span class="pre">PEPS</span></code></a>.</p>
<p>Input data as well as initialization parameters are described in <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.Conv2d.html">torch.nn.Conv2d</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_channels</strong> (<em>int</em>) – Input channels. Same as <code class="docutils literal notranslate"><span class="pre">in_dim</span></code> in <a class="reference internal" href="#tensorkrowch.models.PEPS" title="tensorkrowch.models.PEPS"><code class="xref py py-class docutils literal notranslate"><span class="pre">PEPS</span></code></a>.</p></li>
<li><p><strong>bond_dim</strong> (<em>list</em><em>[</em><em>int</em><em>] or </em><em>tuple</em><em>[</em><em>int</em><em>]</em>) – Bond dimensions for horizontal and vertical edges (in that order). Thus
it should also contain 2 elements</p></li>
<li><p><strong>kernel_size</strong> (<em>int</em><em>, </em><em>list</em><em>[</em><em>int</em><em>] or </em><em>tuple</em><em>[</em><em>int</em><em>]</em>) – <p>Kernel size used in <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.Unfold.html#torch.nn.Unfold">torch.nn.Unfold</a>.
If given as an <code class="docutils literal notranslate"><span class="pre">int</span></code>, the actual kernel size will be
<code class="docutils literal notranslate"><span class="pre">(kernel_size,</span> <span class="pre">kernel_size)</span></code>.</p>
</p></li>
<li><p><strong>stride</strong> (<em>int</em>) – <p>Stride used in <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.Unfold.html#torch.nn.Unfold">torch.nn.Unfold</a>.</p>
</p></li>
<li><p><strong>padding</strong> (<em>int</em>) – <p>Padding used in <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.Unfold.html#torch.nn.Unfold">torch.nn.Unfold</a>.
If given as an <code class="docutils literal notranslate"><span class="pre">int</span></code>, the actual kernel size will be
<code class="docutils literal notranslate"><span class="pre">(kernel_size,</span> <span class="pre">kernel_size)</span></code>.</p>
</p></li>
<li><p><strong>dilation</strong> (<em>int</em>) – <p>Dilation used in <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.Unfold.html#torch.nn.Unfold">torch.nn.Unfold</a>.
If given as an <code class="docutils literal notranslate"><span class="pre">int</span></code>, the actual kernel size will be
<code class="docutils literal notranslate"><span class="pre">(kernel_size,</span> <span class="pre">kernel_size)</span></code>.</p>
</p></li>
<li><p><strong>boundary</strong> (<em>list</em><em>[</em><em>{&quot;obc&quot;</em><em>, </em><em>&quot;pbc&quot;}</em><em>]</em>) – List of strings indicating whether periodic or open boundary conditions
should be used in the horizontal (up and down) and vertical (left and
right) boundaries.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">conv_peps</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">ConvPEPS</span><span class="p">(</span><span class="n">in_channels</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
<span class="gp">... </span>                               <span class="n">bond_dim</span><span class="o">=</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
<span class="gp">... </span>                               <span class="n">kernel_size</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="c1"># batch_size x in_channels x height x width</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">conv_peps</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span><span class="o">.</span><span class="n">shape</span>
<span class="go">torch.Size([20, 1, 1])</span>
</pre></div>
</div>
<dl class="py property">
<dt class="sig sig-object py" id="tensorkrowch.models.ConvPEPS.in_channels">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">in_channels</span></span><a class="headerlink" href="#tensorkrowch.models.ConvPEPS.in_channels" title="Permalink to this definition">#</a></dt>
<dd><p>Returns <code class="docutils literal notranslate"><span class="pre">in_channels</span></code>. Same as <code class="docutils literal notranslate"><span class="pre">in_dim</span></code> in <a class="reference internal" href="#tensorkrowch.models.PEPS" title="tensorkrowch.models.PEPS"><code class="xref py py-class docutils literal notranslate"><span class="pre">PEPS</span></code></a>.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tensorkrowch.models.ConvPEPS.kernel_size">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">kernel_size</span></span><a class="headerlink" href="#tensorkrowch.models.ConvPEPS.kernel_size" title="Permalink to this definition">#</a></dt>
<dd><p>Returns <code class="docutils literal notranslate"><span class="pre">kernel_size</span></code>. Number of rows and columns in the 2D grid is
given by <span class="math notranslate nohighlight">\(kernel\_size_0\)</span> and <span class="math notranslate nohighlight">\(kernel\_size_1\)</span>, respectively.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tensorkrowch.models.ConvPEPS.stride">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">stride</span></span><a class="headerlink" href="#tensorkrowch.models.ConvPEPS.stride" title="Permalink to this definition">#</a></dt>
<dd><p>Returns stride used in <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.Unfold.html#torch.nn.Unfold">torch.nn.Unfold</a>.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tensorkrowch.models.ConvPEPS.padding">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">padding</span></span><a class="headerlink" href="#tensorkrowch.models.ConvPEPS.padding" title="Permalink to this definition">#</a></dt>
<dd><p>Returns padding used in <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.Unfold.html#torch.nn.Unfold">torch.nn.Unfold</a>.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tensorkrowch.models.ConvPEPS.dilation">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dilation</span></span><a class="headerlink" href="#tensorkrowch.models.ConvPEPS.dilation" title="Permalink to this definition">#</a></dt>
<dd><p>Returns dilation used in <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.Unfold.html#torch.nn.Unfold">torch.nn.Unfold</a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensorkrowch.models.ConvPEPS.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tensorkrowch/models/peps.html#ConvPEPS.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensorkrowch.models.ConvPEPS.forward" title="Permalink to this definition">#</a></dt>
<dd><p>Overrides <code class="docutils literal notranslate"><span class="pre">torch.nn.Module</span></code>’s forward to compute a convolution on the input
image.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image</strong> (<em>torch.Tensor</em>) – <p>Input batch of images with shape</p>
<div class="math notranslate nohighlight">
\[batch\_size \times in\_channels \times height \times width\]</div>
</p></li>
<li><p><strong>args</strong> – Arguments that might be used in <a class="reference internal" href="#tensorkrowch.models.PEPS.contract" title="tensorkrowch.models.PEPS.contract"><code class="xref py py-meth docutils literal notranslate"><span class="pre">contract()</span></code></a>.</p></li>
<li><p><strong>kwargs</strong> – Keyword arguments that might be used in <a class="reference internal" href="#tensorkrowch.models.PEPS.contract" title="tensorkrowch.models.PEPS.contract"><code class="xref py py-meth docutils literal notranslate"><span class="pre">contract()</span></code></a>,
like <code class="docutils literal notranslate"><span class="pre">from_size</span></code>, <code class="docutils literal notranslate"><span class="pre">max_bond</span></code> or inline.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="convupeps">
<h3>ConvUPEPS<a class="headerlink" href="#convupeps" title="Permalink to this headline">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="tensorkrowch.models.ConvUPEPS">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tensorkrowch.models.</span></span><span class="sig-name descname"><span class="pre">ConvUPEPS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bond_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dilation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tensorkrowch/models/peps.html#ConvUPEPS"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensorkrowch.models.ConvUPEPS" title="Permalink to this definition">#</a></dt>
<dd><p>Class for Uniform Projected Entangled Pair States, where all nodes are input
nodes, and where the input data is a batch of images. It is the convolutional
version of <a class="reference internal" href="#tensorkrowch.models.UPEPS" title="tensorkrowch.models.UPEPS"><code class="xref py py-class docutils literal notranslate"><span class="pre">UPEPS</span></code></a>.</p>
<p>Input data as well as initialization parameters are described in <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.Conv2d.html">torch.nn.Conv2d</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_channels</strong> (<em>int</em>) – Input channels. Same as <code class="docutils literal notranslate"><span class="pre">in_dim</span></code> in <a class="reference internal" href="#tensorkrowch.models.UPEPS" title="tensorkrowch.models.UPEPS"><code class="xref py py-class docutils literal notranslate"><span class="pre">UPEPS</span></code></a>.</p></li>
<li><p><strong>bond_dim</strong> (<em>list</em><em>[</em><em>int</em><em>] or </em><em>tuple</em><em>[</em><em>int</em><em>]</em>) – Bond dimensions for horizontal and vertical edges (in that order). Thus
it should also contain 2 elements</p></li>
<li><p><strong>kernel_size</strong> (<em>int</em><em>, </em><em>list</em><em>[</em><em>int</em><em>] or </em><em>tuple</em><em>[</em><em>int</em><em>]</em>) – <p>Kernel size used in <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.Unfold.html#torch.nn.Unfold">torch.nn.Unfold</a>.
If given as an <code class="docutils literal notranslate"><span class="pre">int</span></code>, the actual kernel size will be
<code class="docutils literal notranslate"><span class="pre">(kernel_size,</span> <span class="pre">kernel_size)</span></code>.</p>
</p></li>
<li><p><strong>stride</strong> (<em>int</em>) – <p>Stride used in <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.Unfold.html#torch.nn.Unfold">torch.nn.Unfold</a>.</p>
</p></li>
<li><p><strong>padding</strong> (<em>int</em>) – <p>Padding used in <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.Unfold.html#torch.nn.Unfold">torch.nn.Unfold</a>.
If given as an <code class="docutils literal notranslate"><span class="pre">int</span></code>, the actual kernel size will be
<code class="docutils literal notranslate"><span class="pre">(kernel_size,</span> <span class="pre">kernel_size)</span></code>.</p>
</p></li>
<li><p><strong>dilation</strong> (<em>int</em>) – <p>Dilation used in <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.Unfold.html#torch.nn.Unfold">torch.nn.Unfold</a>.
If given as an <code class="docutils literal notranslate"><span class="pre">int</span></code>, the actual kernel size will be
<code class="docutils literal notranslate"><span class="pre">(kernel_size,</span> <span class="pre">kernel_size)</span></code>.</p>
</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">conv_peps</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">ConvPEPS</span><span class="p">(</span><span class="n">in_channels</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
<span class="gp">... </span>                               <span class="n">bond_dim</span><span class="o">=</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
<span class="gp">... </span>                               <span class="n">kernel_size</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">conv_peps</span><span class="o">.</span><span class="n">grid_env</span><span class="p">:</span>
<span class="gp">... </span>    <span class="k">assert</span> <span class="n">node</span><span class="o">.</span><span class="n">tensor_address</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;virtual_uniform&#39;</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="c1"># batch_size x in_channels x height x width</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">conv_peps</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span><span class="o">.</span><span class="n">shape</span>
<span class="go">torch.Size([20, 1, 1])</span>
</pre></div>
</div>
<dl class="py property">
<dt class="sig sig-object py" id="tensorkrowch.models.ConvUPEPS.in_channels">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">in_channels</span></span><a class="headerlink" href="#tensorkrowch.models.ConvUPEPS.in_channels" title="Permalink to this definition">#</a></dt>
<dd><p>Returns <code class="docutils literal notranslate"><span class="pre">in_channels</span></code>. Same as <code class="docutils literal notranslate"><span class="pre">in_dim</span></code> in <a class="reference internal" href="#tensorkrowch.models.UPEPS" title="tensorkrowch.models.UPEPS"><code class="xref py py-class docutils literal notranslate"><span class="pre">UPEPS</span></code></a>.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tensorkrowch.models.ConvUPEPS.kernel_size">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">kernel_size</span></span><a class="headerlink" href="#tensorkrowch.models.ConvUPEPS.kernel_size" title="Permalink to this definition">#</a></dt>
<dd><p>Returns <code class="docutils literal notranslate"><span class="pre">kernel_size</span></code>. Number of rows and columns in the 2D grid is
given by <span class="math notranslate nohighlight">\(kernel\_size_0\)</span> and <span class="math notranslate nohighlight">\(kernel\_size_1\)</span>, respectively.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tensorkrowch.models.ConvUPEPS.stride">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">stride</span></span><a class="headerlink" href="#tensorkrowch.models.ConvUPEPS.stride" title="Permalink to this definition">#</a></dt>
<dd><p>Returns stride used in <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.Unfold.html#torch.nn.Unfold">torch.nn.Unfold</a>.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tensorkrowch.models.ConvUPEPS.padding">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">padding</span></span><a class="headerlink" href="#tensorkrowch.models.ConvUPEPS.padding" title="Permalink to this definition">#</a></dt>
<dd><p>Returns padding used in <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.Unfold.html#torch.nn.Unfold">torch.nn.Unfold</a>.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tensorkrowch.models.ConvUPEPS.dilation">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dilation</span></span><a class="headerlink" href="#tensorkrowch.models.ConvUPEPS.dilation" title="Permalink to this definition">#</a></dt>
<dd><p>Returns dilation used in <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.Unfold.html#torch.nn.Unfold">torch.nn.Unfold</a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensorkrowch.models.ConvUPEPS.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tensorkrowch/models/peps.html#ConvUPEPS.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensorkrowch.models.ConvUPEPS.forward" title="Permalink to this definition">#</a></dt>
<dd><p>Overrides <code class="docutils literal notranslate"><span class="pre">torch.nn.Module</span></code>’s forward to compute a convolution on the input
image.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image</strong> (<em>torch.Tensor</em>) – <p>Input batch of images with shape</p>
<div class="math notranslate nohighlight">
\[batch\_size \times in\_channels \times height \times width\]</div>
</p></li>
<li><p><strong>args</strong> – Arguments that might be used in <a class="reference internal" href="#tensorkrowch.models.PEPS.contract" title="tensorkrowch.models.PEPS.contract"><code class="xref py py-meth docutils literal notranslate"><span class="pre">contract()</span></code></a>.</p></li>
<li><p><strong>kwargs</strong> – Keyword arguments that might be used in <a class="reference internal" href="#tensorkrowch.models.PEPS.contract" title="tensorkrowch.models.PEPS.contract"><code class="xref py py-meth docutils literal notranslate"><span class="pre">contract()</span></code></a>,
like <code class="docutils literal notranslate"><span class="pre">from_size</span></code>, <code class="docutils literal notranslate"><span class="pre">max_bond</span></code> or inline.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
</section>
</section>


              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="operations.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Operations</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="initializers.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Initializers</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By José Ramón Pareja Monturiol<br/>
  
      &copy; Copyright 2023, José Ramón Pareja Monturiol.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>